!function(e,t,a,o,s,i,n){e.GoogleAnalyticsObject=s,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,i=t.createElement(a),n=t.getElementsByTagName(a)[0],i.async=1,i.src="https://www.google-analytics.com/analytics.js",n.parentNode.insertBefore(i,n)}(window,document,"script",0,"ga"),ga("create","UA-126270057-1","auto"),ga("set","checkProtocolTask",function(){}),ga("require","displayfeatures"),ga("send","pageview","/productdesigntips.html");var config={apiKey:"AIzaSyBDmZsXrDi6xnUeu_fXmoHh0StKjYCthvk",authDomain:"uxunicorns-fca1e.firebaseapp.com",databaseURL:"https://uxunicorns-fca1e.firebaseio.com",projectId:"uxunicorns-fca1e",storageBucket:"gs://uxunicorns-fca1e.appspot.com",messageingSenderId:"752488928557"};firebase.initializeApp(config);var db=firebase.database();chrome.storage.local.get(["autoDarkMode","extension_message","functionalMode","colorInspiration","nextUpdate"],function(e){checkViewMode(e.autoDarkMode),e.extension_message&&e.extension_message.display&&(document.getElementById("extension-message-container").style.display="flex",document.getElementById("extension-message").innerHTML=e.extension_message.message);let t=new Date;e.nextUpdate?t>=e.nextUpdate&&chrome.runtime.sendMessage({updateData:"updateData"},e=>{}):chrome.runtime.sendMessage({updateData:"updateData"},e=>{})});var menuSettingsButton=document.getElementById("less-button");function getPostByCategory(e,t){postsByCategory=[],firebase.database().ref("/posts_by_category/"+e).on("value",function(a){(postsByCategory=a.val()).sort(sortbydate),t(e,getContentPage)},function(e){console.log("The read failed: "+e.code)})}function getSectionsByCategory(e,t){sectionsByCategory=[],firebase.database().ref("/category_web/"+e+"/sections").on("value",function(a){sectionsByCategory=a.val(),t(e)},function(e){console.log("The read failed: "+e.code)})}function getSectionsMenuItems(){Object.keys(sectionsByCategory).forEach(e=>{$(".categories-navigation-button."+e).css("display","table")})}function sortbydate(e,t){return e.create_date==t.create_date?e.title>t.title?1:e.title<t.title?-1:0:e.create_date>t.create_date?-1:1}function sortbydate_category(e,t){return e.created_date==t.created_date?e.title>t.title?1:e.title<t.title?-1:0:e.created_date>t.created_date?-1:1}function get_array_value_from_storage(e,t){chrome.storage.local.get(null,function(a){var o,s=[];for(count=a[e+"_count"],void 0===count&&(count=0),o=0;o<count;o++){var i=e+"_"+o;s.push(a[i])}t(s)})}function getsite(e){let t=e.indexOf("://");-1==t?t=0:t+=3;let a=e.indexOf("/",t),o="";return o=-1==a?e.substring(t):e.substring(t,a)}function sort_category_by_post(e,t){for(var a=[],o=0;o<=e.length;o++)a[o]=0;var s=[],i=0;for(o=0;o<t.length;o++)if(0==a[t[o].category_id]){for(var n=0;n<e.length;n++)if(e[n].id==t[o].category_id){s.push(e[n]),i++,a[t[o].category_id]=1;break}if(i==e.length)break}if(i<e.length)for(o=0;o<e.length&&(0!=a[e[o].id]||(s.push(e[o]),a[e[o].id]=1,++i!=e.length));o++);return s}function getrandomdelay(){return Math.floor(1e3*Math.random())}menuSettingsButton.addEventListener("click",toggleSettingsMenu);var category_display,listsSortable,posts=[],postsByCategory=[],temp_posts=[],category=[],temp_category=[],new_job_position=5,category_color=[];function getBookmarks(){ga("send","pageview","workspace-open"),$(".container-fluid").removeClass("content"),chrome.storage.local.set({isWorkspaceOpen:!0}),document.getElementById("share-button").style.display="none",document.getElementById("extension-message-container").classList.remove("style2"),document.getElementById("extension-message-container").classList.add("style1"),chrome.tabs.query({active:!1,currentWindow:!0},e=>{chrome.storage.local.get(["workspaces","currentWorkspaceId","workspacesCount","functionalMode","images","viewMode","workspaceTemplates"],t=>{chrome.storage.local.get(["bookmarks"],a=>{if(a.bookmarks){var o="";if(o='<div class="row bookmarks">',o+='<div id="bookmark-list-container" class="droptarget list-group">',0==a.bookmarks.length){for(key in o+='<div class="ad-card-div blank" id="blank-placeholder">',o+='<div class="bookmark-list-blank-container">',o+='<div class="start-here-title">Start here &#11015;</div>',o+='<div class="start-here-text">Workspaces can be used to organize your workflow and share results</div>',o+='<div class="start-here-subtitle">Populate an example:</div>',t.workspaceTemplates)o+='<div class="workspace-template start-here-button">'+key+"</div>";o+='<div class="start-here-text">Create a new column and add links, notes, lists, images and iframes</div>',o+='<div class="start-here-subtitle">Create:</div>',o+='<div class="start-here-button blank">Blank column</div>',o+='<div class="start-here-button tabs">Column from open tabs</div>',o+='<div class="start-here-button template">Column using UX template</div>',o+="</div>",o+="</div>"}else Object.values(a.bookmarks).forEach(e=>{o+='<div class="ad-card-div bookmarks" data-id="'+e.listId+'">',o+='<div class="bookmark-tools-container">',o+='<div class="bookmark-tools add-text"><span></span><p>Text</p></div>',o+='<div class="bookmark-tools add-header"><span></span><p>Subtitle</p></div>',o+='<div class="bookmark-tools add-checklist"><span></span><p>Checkbox</p></div>',o+='<div class="bookmark-tools add-link"><span></span><p>Link</p></div>',o+='<div class="bookmark-tools add-image"><span></span><p>Image</p></div>',o+='<div class="bookmark-tools add-quote"><span></span><p>Quote</p></div>',o+='<div class="bookmark-tools add-media"><span></span><p>Media (iframe)</p></div>',o+="</div>",o+='<div class="bookmark-list-menu-container">',o+='<div class="bookmark-list-menu-open"></div>',o+='<div class="bookmark-list-menu-items">',o+='<p class="bookmark-list-menu items open-current">Open links in current window</p>',o+='<p class="bookmark-list-menu items open-new">Open links in new window</p>',o+='<p class="bookmark-list-menu items open-duplicate">Duplicate column</p>',o+='<p class="bookmark-list-menu items remove-list">Delete column</p>',o+="</div>",o+="</div>",o+='<h1 class="bookmark-list-title contenteditable">'+e.listTitle+"</h1>",o+='<div class="bookmark-list-links put-tabs">',e.listBookmarks.forEach(e=>{if(e)if(e.header)o+='<p class="bookmark-capture">'+e.header+"</p>";else if(e.quote)o+='<div class="bookmark-quote"><div class="bookmark-quote-img"></div><div class="bookmark-quote-p">'+e.quote+"</div></div>";else if(e.text)o+='<div class="bookmark-text"><div class="bookmark-text-p">'+e.text+"</div></div>";else if(e.image)if("_none"==e.image){let t=(new Date).getTime();o+='<div class="bookmark-image undone"><input type="file" accept="image/*" class="bookmark-image-file" id="inp'+t+'"><label class="bookmark-image-content" for="inp'+t+'"><div class="image-cloud"></div><div class="image-drop">Drop file here</div><div class="image-jpg">JPG, GIF, PNG</div></label><div class="bookmark-image-caption">'+e.caption+"</div></div>"}else{let a=new Image,s=t.images[e.image];a.src="data:image/png;base64,"+s,o+='<div class="bookmark-image"><div class="bookmark-image-container"><img class="bookmark-image-img" src="'+a.src+'" alt=""></div><div class="bookmark-image-caption">'+e.caption+"</div></div>"}else if(e.url)o+='<div class="bookmark-container"><a href="'+e.url+'" class="bookmark-link"><div class="bookmark-favicon"><img src="'+e.favIconUrl+'" alt=""></div><p class="bookmark-title" title="'+e.title+'">'+e.title+"</p></a></div>";else if(e.checklistTitle){let a,s="";e.isChecked?(a="/img/circle_checked.svg","dark"==t.viewMode&&(a="/img/circle_checked_dark.svg"),s=" active"):(a="/img/circle_unchecked.svg","dark"==t.viewMode&&(a="/img/circle_unchecked_dark.svg")),o+='<div class="bookmark-checklist"><span class="bookmark-checklist-toggler"><img src="'+a+'" class="bookmark-checklist-icon" alt=""></span><p class="bookmark-checklist-title'+s+'">'+e.checklistTitle+"</p></div>"}else e.media&&(o+='<div class="bookmark-media"><div class="bookmark-media-content"><iframe class="bookmark-iframe" src="'+e.media+'"></iframe></div><div class="bookmark-media-caption">'+e.caption+"</div></div>")}),o+="</div>",o+='<div class="bookmark-link-menu-container">',o+='<div class="bookmark-link-menu tools"><span></span>Add item</div>',o+='<div class="bookmark-link-menu remove-link" title="Drag & drop item here to delete"></div>',o+="</div>",o+="</div>"});o+="</div>",o+='<div class="ad-card-div share-tabs">',o+='<div class="sidebar-right-container">',o+='<div class="sidebar-right element publish" id="publish-popup-open">Share workspace</div>',o+='<div class="sidebar-right element new" id="create-new-column">+ Add new column</div>',o+="</div>",o+='<div class="bookmark-list-links share-tabs" id="bookmark-share-list">',o+='<p class="bookmark-capture">Current open tabs</p>',e.forEach((e,t)=>{o+='<div class="bookmark-container" data-link="'+e.id+'"><a href="'+e.url+'" class="bookmark-link"><img class="bookmark-favicon" src="'+e.favIconUrl+'" alt=""><p class="bookmark-title" title="'+e.title+'">'+e.title+"</p></a></div>"}),o+="</div>",o+="</div>",o+="</div>",document.body.style.height="100vh",$("#main-content").html(o),$(".ad-card-div").each(function(){$(this).delay(getrandomdelay()).animate({opacity:"1"},100)}),rebuildAsideNavWorkspaces(),setBookmarksListWidth(),addListeners()}else{let e=document.createElement("div");e.className="something-went-wrong-container";let t='<div class="something-went-wrong">';t+="<p>Oops, something went wrong :(</p>",t+="<p>Login to recover data or reinstall extension</p>",t+="</div>",e.innerHTML=t,document.getElementById("main-content").appendChild(e)}"workspace"==t.functionalMode?(makeWorkspaceCounter("reset"),setTimeout(()=>{makeWorkspaceCounter("current")},100)):makeWorkspaceCounter("current");let s=document.createElement("div");s.id="support-button",s.className="support-button",s.innerHTML='<a href="https://join.slack.com/t/productdesigntips/shared_invite/zt-90k78b9g-TvbJG_m_w15HZU3EjDGdHw"><img src="/img/menu_icon_slack_color.svg" alt><span class="support-button-text">Support</span></a>',document.querySelector(".container-fluid").prepend(s)})})})}function setBookmarksListWidth(){let e,t=document.body.offsetWidth-92,a=document.getElementsByClassName("ad-card-div"),o=a.length;if(t/o>=360)e=360;else if(t/o>=330&&t/o<360)e=t/o-3;else{e=t/Math.floor(t/330)-3}for(var s=0;s<o;s++)a[s].style.width=e+"px",a[s].style.minWidth=e+"px"}function addListeners(){document.getElementById("bookmark-list-container");let e=document.getElementById("bookmark-share-list"),t=document.querySelectorAll(".bookmark-list-links.put-tabs"),a=document.querySelectorAll(".bookmark-tools.add-text"),o=document.querySelectorAll(".bookmark-tools.add-header"),s=document.querySelectorAll(".bookmark-tools.add-image"),i=document.querySelectorAll(".bookmark-tools.add-link"),n=document.querySelectorAll(".bookmark-tools.add-checklist"),r=document.querySelectorAll(".bookmark-tools.add-quote"),c=document.querySelectorAll(".bookmark-tools.add-media"),l=document.querySelectorAll(".bookmark-link-menu.remove-link"),d=document.getElementById("create-new-column"),m=document.querySelectorAll(".bookmark-list-menu-open"),u=document.querySelectorAll(".bookmark-link-menu.tools"),p=document.querySelectorAll(".bookmark-list-menu.open-current"),k=document.querySelectorAll(".bookmark-list-menu.open-new"),g=document.querySelectorAll(".bookmark-list-menu.open-duplicate"),v=(document.querySelectorAll(".bookmark-list-menu.save-template"),document.querySelectorAll(".bookmark-list-menu.remove-list")),h=document.querySelectorAll(".bookmark-list-title.contenteditable"),b=document.querySelectorAll(".bookmark-capture"),y=document.querySelectorAll(".bookmark-text"),f=document.querySelectorAll(".bookmark-media-caption"),w=document.querySelectorAll(".bookmark-media-content"),L=document.querySelectorAll(".bookmark-image"),E=document.querySelectorAll(".bookmark-checklist-toggler"),S=document.querySelectorAll(".bookmark-checklist"),C=document.querySelectorAll(".bookmark-quote"),I=document.getElementById("publish-popup-open"),T=document.getElementById("blank-placeholder");d.addEventListener("click",createNewColumn),a.forEach(e=>{e.addEventListener("click",showTextInput)}),o.forEach(e=>{e.addEventListener("click",showHeaderInput)}),s.forEach(e=>{e.addEventListener("click",showImageInput)}),i.forEach(e=>{e.addEventListener("click",showLinkInput)}),n.forEach(e=>{e.addEventListener("click",addChecklist)}),r.forEach(e=>{e.addEventListener("click",showQuoteInput)}),c.forEach(e=>{e.addEventListener("click",showMediaInput)}),m.forEach(e=>{e.addEventListener("click",openBookmarksListMenu)}),p.forEach(e=>{e.addEventListener("click",openBookmarksList),e.newWindow=!1}),k.forEach(e=>{e.addEventListener("click",openBookmarksList),e.newWindow=!0}),g.forEach(e=>{e.addEventListener("click",duplicateBookmarksList)}),v.forEach(e=>{e.addEventListener("click",removeBookmarksList)}),h.forEach(e=>{e.addEventListener("dblclick",editListItem),e.itemType="title"}),y.forEach(e=>{e.addEventListener("dblclick",editListItem),e.itemType="text"}),b.forEach(e=>{e.addEventListener("dblclick",editListItem),e.itemType="capture"}),f.forEach(e=>{e.addEventListener("dblclick",editListItem),e.itemType="mediaCaption"}),w.forEach(e=>{e.addEventListener("click",previewListMedia)}),L.forEach(e=>{e.classList.contains("undone")?(["dragenter","dragover","dragleave","drop"].forEach(t=>{e.addEventListener(t,imagePreventDefaults,!1),document.body.addEventListener(t,imagePreventDefaults,!1)}),e.children[0].addEventListener("change",function(t){let a=t.target.files[0];a&&uploadFile(a,e,e.parentElement)},!1),e.addEventListener("drop",function(t){let a=t.dataTransfer.files[0];a&&uploadFile(a,e,e.parentElement)},!1),e.children[2].itemType="imageCaption",e.children[2].addEventListener("dblclick",editListItem)):(e.itemType="image",e.children[0].addEventListener("click",previewListImage),e.children[1].itemType="imageCaption",e.children[1].addEventListener("dblclick",editListItem))}),E.forEach(e=>{e.addEventListener("click",toggleChecked)}),S.forEach(e=>{e.children[1].addEventListener("dblclick",editListItem),e.itemType="checklist",e.children[1].itemType="checklistTitle"}),C.forEach(e=>{e.addEventListener("dblclick",editListItem),e.itemType="quote"}),u.forEach(e=>{e.addEventListener("click",openToolsMenu)}),I.addEventListener("click",getPublishPopup),T&&(document.querySelector(".start-here-button.blank").addEventListener("click",()=>addBookmarksList()),document.querySelector(".start-here-button.tabs").addEventListener("click",()=>addBookmarksList(!0)),document.querySelector(".start-here-button.template").addEventListener("click",createNewColumn),document.querySelectorAll(".workspace-template").forEach(e=>e.addEventListener("click",addExampleWorkspace))),new Sortable(e,{group:{name:"share",pull:!0,put:!1},animation:0,sort:!1,onRemove:shareBookmarksLinks,forceFallback:!0,fallbackTolerance:7});for(var _=0;_<t.length;_++)new Sortable(t[_],{group:{name:"links",put:!0},animation:0,sort:!0,onAdd:moveBookmarksLinks,onUpdate:sortBookmarksLinks,forceFallback:!0,fallbackTolerance:7,scroll:!0,bubbleScroll:!0,scrollSensitivity:100,onStart:function(e){document.documentElement.classList.add("draggable-cursor")},onEnd:function(e){document.documentElement.classList.remove("draggable-cursor")}});l.forEach(e=>e.addEventListener("click",showRemoveTooltip));for(_=0;_<l.length;_++)new Sortable(l[_],{group:{name:"remove",pull:!1,put:"links"},animation:0,sort:!1,pullMode:!1,onStart:l[_].addEventListener("dragenter",e=>{e.target.classList.toggle("active")}),onStart:l[_].addEventListener("dragleave",e=>{e.target.classList.toggle("active")}),onStart:l[_].addEventListener("drop",e=>{e.target.classList.toggle("active")}),onAdd:removeBookmarksLinks});addListsSortable()}function addListsSortable(){let e=document.getElementById("bookmark-list-container");listsSortable&&listsSortable.destroy(),listsSortable=new Sortable(e,{group:{name:"lists",pull:"share",put:!1},animation:0,sort:!0,chosenClass:"sortable-chosen",dragClass:"sortable-drag",ghostClass:"sortable-ghost",filter:"input",preventOnFilter:!1,onEnd:moveBookmarksList,forceFallback:!0,fallbackTolerance:7,scroll:!0,bubbleScroll:!0,scrollSensitivity:100,scrollSpeed:20})}function addMenuListeners(){let e=firebase.auth().currentUser,t=document.querySelectorAll(".workspace-open.unlocked"),a=document.querySelectorAll(".workspace-menu.unlocked"),o=document.querySelectorAll(".workspace-open.locked"),s=document.querySelectorAll(".workspace-menu.locked");t.forEach(e=>{e.addEventListener("click",switchWorkspace)}),a.forEach(e=>{e.addEventListener("click",workspaceMenuShow)}),e?(o.forEach(e=>{e.addEventListener("click",choosePlan)}),s.forEach(e=>{e.addEventListener("click",choosePlan)})):(o.forEach(e=>{e.addEventListener("click",getLoginForm)}),s.forEach(e=>{e.addEventListener("click",getLoginForm)}))}function editListItem(e){let t,a=e.currentTarget,o=a.itemType,s=!1;switch(o){case"text":t=a.children[0];break;case"capture":t=a;break;case"checklistTitle":t=a,a=a.parentElement;break;case"quote":t=a.children[1];break;case"imageCaption":case"mediaCaption":t=a;break;default:t=a,s=!0}let i=t.innerHTML;function n(e){if(13===e.keyCode){if("text"!=o&&"quote"!=o)if(""!=t.innerHTML){t.removeEventListener("keydown",n),t.removeEventListener("blur",r),t.removeEventListener("paste",c);let a=t.innerHTML;i!==a&&a.replace(/\s/g,"").length?l(a):t.innerHTML=i,e.preventDefault(),t.setAttribute("contenteditable",!1),t.style.cursor="default",t.style.outline="",window.getSelection().removeAllRanges()}else e.preventDefault(),animateCSS(a,"shake"),t.innerHTML=""}else if(27===e.keyCode){t.removeEventListener("keydown",n),t.removeEventListener("blur",r),t.removeEventListener("paste",c),t.setAttribute("contenteditable",!1),t.innerHTML=i,t.style.cursor="default",t.style.outline="",window.getSelection().removeAllRanges()}}function r(e){if(""!=t.innerHTML){e.preventDefault(),t.setAttribute("contenteditable",!1);let a=t.innerHTML;t.style.cursor="default",t.style.outline="",t.removeEventListener("keydown",n),t.removeEventListener("blur",r),t.removeEventListener("paste",c),window.getSelection().removeAllRanges(),l(a)}else if(s){t.innerHTML=i;let e=t.innerHTML;t.style.cursor="default",t.style.outline="",t.removeEventListener("keydown",n),t.removeEventListener("blur",r),t.removeEventListener("paste",c),window.getSelection().removeAllRanges(),l(e)}else chrome.storage.local.get(["bookmarks"],function(e){let t=getNodeIndex(a),o=getNodeIndex(a.parentElement.parentElement);e.bookmarks[o].listBookmarks=[...e.bookmarks[o].listBookmarks.slice(0,t),...e.bookmarks[o].listBookmarks.slice(t+1)],chrome.storage.local.set({bookmarks:e.bookmarks},()=>a.remove())})}function c(e){e.preventDefault();let t=e.clipboardData.getData("text/plain");t=t.replace(/\</g,"&lt;").replace(/\>/g,"&gt;"),document.execCommand("insertHTML",!1,t)}function l(e){chrome.storage.local.get(["bookmarks"],function(t){if("capture"===o){let o=getNodeIndex(a),s=getNodeIndex(a.parentElement.parentElement);t.bookmarks[s].listBookmarks[o].header=e,chrome.storage.local.set({bookmarks:t.bookmarks})}else if("checklistTitle"===o){let o=getNodeIndex(a),s=getNodeIndex(a.parentElement.parentElement);t.bookmarks[s].listBookmarks[o].checklistTitle=e,chrome.storage.local.set({bookmarks:t.bookmarks})}else if("text"===o){let o=getNodeIndex(a),s=getNodeIndex(a.parentElement.parentElement);t.bookmarks[s].listBookmarks[o].text=e,chrome.storage.local.set({bookmarks:t.bookmarks})}else if("quote"===o){let o=getNodeIndex(a),s=getNodeIndex(a.parentElement.parentElement);t.bookmarks[s].listBookmarks[o].quote=e,chrome.storage.local.set({bookmarks:t.bookmarks})}else if("imageCaption"===o){let o=getNodeIndex(a.parentElement),s=getNodeIndex(a.parentElement.parentElement.parentElement);t.bookmarks[s].listBookmarks[o].caption=e,chrome.storage.local.set({bookmarks:t.bookmarks})}else if("mediaCaption"===o){let o=getNodeIndex(a.parentElement),s=getNodeIndex(a.parentElement.parentElement.parentElement);t.bookmarks[s].listBookmarks[o].caption=e,chrome.storage.local.set({bookmarks:t.bookmarks})}else{let o=getNodeIndex(a.parentElement);t.bookmarks[o].listTitle=e,chrome.storage.local.set({bookmarks:t.bookmarks})}})}t.setAttribute("contenteditable",!0),t.focus(),t.style.cursor="auto",t.style.outline="1px solid #65B1E8",document.execCommand("selectAll",!1,null),t.addEventListener("keydown",n),t.addEventListener("blur",r),t.addEventListener("paste",c)}function showTextInput(e){let t=e.target.closest(".ad-card-div").children[3],a=document.createElement("div");a.className="bookmark-text",a.innerHTML='<div class="bookmark-text-p">Text</div>',t.appendChild(a),a.itemType="text",t.scrollTop=t.scrollHeight;let o=getNodeIndex(t.parentElement);chrome.storage.local.get(["bookmarks"],function(e){e.bookmarks[o].listBookmarks.push({text:a.innerHTML}),chrome.storage.local.set({bookmarks:e.bookmarks})}),a.addEventListener("dblclick",editListItem),a.dispatchEvent(new Event("dblclick"))}function showQuoteInput(e){let t=e.target.closest(".ad-card-div").children[3],a=document.createElement("div");a.className="bookmark-quote",a.innerHTML='<div class="bookmark-quote-img"></div><div class="bookmark-quote-p">Quote</div>',t.appendChild(a),a.itemType="quote",t.scrollTop=t.scrollHeight;let o=getNodeIndex(t.parentElement);chrome.storage.local.get(["bookmarks"],function(e){e.bookmarks[o].listBookmarks.push({quote:a.children[1].innerHTML}),chrome.storage.local.set({bookmarks:e.bookmarks})}),a.addEventListener("dblclick",editListItem),a.dispatchEvent(new Event("dblclick"))}function showHeaderInput(e){let t=e.target.closest(".ad-card-div").children[3],a=document.createElement("div");a.className="bookmark-capture",a.innerHTML="Subtitle",t.appendChild(a),a.itemType="capture",t.scrollTop=t.scrollHeight;let o=getNodeIndex(t.parentElement);chrome.storage.local.get(["bookmarks"],function(e){e.bookmarks[o].listBookmarks.push({header:a.innerHTML}),chrome.storage.local.set({bookmarks:e.bookmarks})}),a.addEventListener("dblclick",editListItem),a.dispatchEvent(new Event("dblclick"))}function showImageInput(e){let t=e.target.closest(".ad-card-div").children[3],a=document.createElement("div");a.className="bookmark-image undone";let o=(new Date).getTime();a.innerHTML='<input type="file" accept="image/*" class="bookmark-image-file" id="inp'+o+'"><label class="bookmark-image-content" for="inp'+o+'"><div class="image-cloud"></div><div class="image-drop">Drop file here</div><div class="image-jpg">JPG, GIF, PNG</div></label><div class="bookmark-image-caption">Image caption</div>',t.appendChild(a),["dragenter","dragover","dragleave","drop"].forEach(e=>{a.addEventListener(e,imagePreventDefaults,!1),document.body.addEventListener(e,imagePreventDefaults,!1)}),t.scrollTop=t.scrollHeight,a.children[0].addEventListener("change",function(e){let o=e.target.files[0];o&&uploadFile(o,a,t)},!1),a.addEventListener("drop",function(e){let o=e.dataTransfer.files[0];o&&uploadFile(o,a,t)},!1),a.children[2].itemType="imageCaption",a.children[2].addEventListener("dblclick",editListItem);let s=getNodeIndex(t.parentElement);chrome.storage.local.get(["bookmarks"],function(e){e.bookmarks[s].listBookmarks.push({image:"_none",caption:"Image caption"}),chrome.storage.local.set({bookmarks:e.bookmarks})})}function uploadFile(e,t,a){chrome.storage.local.get(["bookmarks"],o=>{const s=getNodeIndex(t),i=getNodeIndex(a.parentElement),n=o.bookmarks[i].listBookmarks[s].caption;t.className="bookmark-image",t.innerHTML='<div class="bookmark-image-content"><img class="bookmark-image-img loading" src="/img/circle_loading_img.png"alt=""></div><div class="bookmark-image-caption">'+n+"</div>";const r=new Image;r.src=URL.createObjectURL(e),r.onload=(()=>{const e=r.src,a=(new Date).getTime();o.bookmarks[i].listBookmarks[s]={image:"img_"+a,caption:n},chrome.storage.local.set({bookmarks:o.bookmarks});const c=getBase64Image(r),l="img_"+a;chrome.storage.local.get(["images"],e=>{e.images[l]=c,chrome.storage.local.set({images:e.images})}),t.className="bookmark-image",t.innerHTML='<div class="bookmark-image-container"><img class="bookmark-image-img" src="'+e+'" alt=""></div><div class="bookmark-image-caption">'+n+"</div>",t.itemType="image",t.children[0].addEventListener("click",previewListImage),t.children[1].itemType="imageCaption",t.children[1].addEventListener("dblclick",editListItem)}),r.onerror=(()=>{t.className="bookmark-image",t.innerHTML='<div class="bookmark-image-content"><img class="bookmark-image-img" src="/img/image_not_found.svg" alt=""></div><div class="bookmark-image-caption">'+n+"</div>",t.itemType="image",t.children[0].addEventListener("click",previewListImage),t.children[1].itemType="imageCaption",t.children[1].addEventListener("dblclick",editListItem)})})}function getBase64Image(e){const t=document.createElement("canvas");let a,o,s=e.width,i=e.height;if(s<1e3&&i<1e3)a=s,o=i;else if(s>i){a=1e3,o=1e3*(i/s)}else{o=1e3,a=1e3*(s/i)}return t.width=a,t.height=o,t.getContext("2d").drawImage(e,0,0,a,o),t.toDataURL("image/png").replace(/^data:image\/(png|jpg);base64,/,"")}function setBase64Image(e){const t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t.toDataURL("image/png").replace(/^data:image\/(png|jpg);base64,/,"")}function uploadToFireStorage(e,t){const a=firebase.auth().currentUser;let o=function(e,t){t=t||"";for(var a=atob(e),o=a.length,s=Math.ceil(o/1024),i=new Array(s),n=0;n<s;++n){for(var r=1024*n,c=Math.min(r+1024,o),l=new Array(c-r),d=r,m=0;d<c;++m,++d)l[m]=a[d].charCodeAt(0);i[n]=new Uint8Array(l)}return new Blob(i,{type:t})}(t,"image/png");const s=firebase.storage().ref().child("user_images/"+a.uid+"/"+e).put(o);s.on("state_changed",e=>{},e=>{console.log(e)},()=>{s.snapshot.ref.getDownloadURL().then(function(e){return e})})}function uploadFile_Old(e,t,a){let o=new Image;o.onload=(()=>{let s=firebase.auth().currentUser,i=t.children[2].innerHTML;if(s){let o=firebase.storage().ref().child(s.uid+"/"+e.name).put(e);o.on("state_changed",e=>{t.className="bookmark-image",t.innerHTML='<div class="bookmark-image-content"><img class="bookmark-image-img loading" src="/img/circle_loading_img.png"alt=""></div><div class="bookmark-image-caption">Image caption</div>'},e=>{console.log(e)},()=>{o.snapshot.ref.getDownloadURL().then(function(e){t.className="bookmark-image",t.innerHTML='<div class="bookmark-image-container"><img class="bookmark-image-img" src="'+e+'" alt=""></div><div class="bookmark-image-caption">'+i+"</div>",t.itemType="image",t.children[0].addEventListener("click",previewListImage),t.children[1].itemType="imageCaption",t.children[1].addEventListener("dblclick",editListItem),chrome.storage.local.get(["bookmarks"],function(o){let s=getNodeIndex(t),n=getNodeIndex(a.parentElement);o.bookmarks[n].listBookmarks[s]={image:e,caption:i},chrome.storage.local.set({bookmarks:o.bookmarks})})})})}else getLoginForm(),t.children[0].value="";URL.revokeObjectURL(o.src)}),o.src=URL.createObjectURL(e)}function imagePreventDefaults(e){e.preventDefault(),e.stopPropagation()}function previewListImage(){const e=event.currentTarget.querySelector("img").getAttribute("src");let t=document.createElement("div");t.className="modal-overlay";let a=document.createElement("div");a.className="modal-overlay-close",a.id="modal-overlay-close",t.appendChild(a);let o=document.createElement("div");o.className="bookmark-image-preview",o.innerHTML='<img src="'+e+'" alt="">',t.appendChild(o),document.body.appendChild(t),t.addEventListener("click",e=>{let a=document.querySelector(".bookmark-image-preview");e.target!=a&&document.body.removeChild(t)})}function showLinkInput(e){let t=e.target.closest(".ad-card-div").children[3],a=document.createElement("div");a.className="bookmark-container",a.innerHTML='<a href="#" class="bookmark-link"><img class="bookmark-favicon" src="/img/icon_link.svg" alt=""><p class="bookmark-title">http://</p></a>',t.appendChild(a),a.itemType="url",t.scrollTop=t.scrollHeight;let o=a.children[0].children[1];function s(e){if(o.removeEventListener("blur",i),13===e.keyCode){e.preventDefault(),o.removeEventListener("blur",i);const c=o.innerHTML;if(""!=c){const e=c,l=e;a.innerHTML='<a href="'+e+'" class="bookmark-link"><img class="bookmark-favicon loading" src="/img/circle_loading.png" alt=""><p class="bookmark-title">'+l+"</p></a>",a.style.opacity=.4;const d="https://www.google.com/s2/favicons?domain="+e;if(n(e)){const i=t,n=getNodeIndex(t.parentElement);getLinkTitle(a,e,d,n,i),o.removeEventListener("keydown",s),o.removeEventListener("paste",r)}else{const n=t,c=getNodeIndex(t.parentElement);o.setAttribute("contenteditable",!1),o.style.cursor="default",o.style.outline="",o.removeEventListener("keydown",s),o.removeEventListener("blur",i),o.removeEventListener("paste",r),window.getSelection().removeAllRanges(),getLinkSimpleTitle(a,e,c,n)}}else animateCSS(a,"shake"),o.addEventListener("blur",i)}else 27===e.keyCode?a.remove():o.addEventListener("blur",i)}function i(e){const c=o.innerHTML,l=c;if(""!=c){a.innerHTML='<a href="'+c+'" class="bookmark-link"><img class="bookmark-favicon loading" src="/img/circle_loading.png" alt=""><p class="bookmark-title">'+l+"</p></a>",a.style.opacity=.4;const e="https://www.google.com/s2/favicons?domain="+c;if(n(c)){const i=t,n=getNodeIndex(t.parentElement);getLinkTitle(a,c,e,n,i),o.removeEventListener("keydown",s),o.removeEventListener("paste",r)}else{const e=t,n=getNodeIndex(t.parentElement);o.setAttribute("contenteditable",!1),o.style.cursor="default",o.style.outline="",o.removeEventListener("keydown",s),o.removeEventListener("blur",i),o.removeEventListener("paste",r),window.getSelection().removeAllRanges(),getLinkSimpleTitle(a,c,n,e)}}else a.remove()}function n(e){if(new RegExp(/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi).test(e)){let t=e.slice(0,7),a=e.slice(0,8);if("http://"==t||"https://"==a)return!0}return!1}function r(e){e.preventDefault();let t=e.clipboardData.getData("text/plain");t=t.replace(/\</g,"&lt;").replace(/\>/g,"&gt;"),document.execCommand("insertHTML",!1,t)}o.setAttribute("contenteditable",!0),o.focus(),o.style.cursor="auto",o.style.outline="1px solid #65B1E8",document.execCommand("selectAll",!1,null),o.addEventListener("keydown",s),o.addEventListener("blur",i),o.addEventListener("paste",r)}function showMediaInput(e){let t=e.target.closest(".ad-card-div").children[3],a=document.createElement("div");a.className="bookmark-media",a.innerHTML='<textarea class="bookmark-media-content edit" placeholder="<iframe></iframe>"></textarea>',t.appendChild(a),t.scrollTop=t.scrollHeight;let o=a.firstChild;function s(e){o.removeEventListener("blur",i),13===e.keyCode?(e.preventDefault(),n()):27===e.keyCode?a.remove():o.addEventListener("blur",i)}function i(e){n()}function n(e){const n=o.value,c=n.startsWith("<iframe"),l=n.includes('src="http');let d;var m;if(d=c&&l?n.split('src="').pop().split('"')[0]:n,m=d,new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+=-]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(m)){a.innerHTML='<div class="bookmark-media-content loading"><img class="bookmark-favicon loading" src="/img/circle_loading.png" alt=""><iframe class="bookmark-iframe loading" src="'+d+'"></frame></div>';let e=document.querySelector("iframe.loading");o.removeEventListener("blur",i),o.removeEventListener("keydown",s),e.addEventListener("load",r),function(e){const a=getNodeIndex(t.parentElement);chrome.storage.local.get(["bookmarks"],function(t){let o=t.bookmarks[a].listBookmarks;o.push({media:e,caption:"Iframe caption"}),chrome.storage.local.set({bookmarks:t.bookmarks})})}(d)}else animateCSS(a,"shake"),o.focus(),o.addEventListener("blur",i)}function r(){let e=a.querySelector("img"),t=a.querySelector("iframe"),n=a.firstChild;e.remove(),t.classList.remove("loading"),n.classList.remove("loading");let c=document.createElement("div");c.className="bookmark-media-caption",c.innerHTML="Iframe caption",a.appendChild(c),o.removeEventListener("blur",i),o.removeEventListener("keydown",s),t.removeEventListener("load",r),c.itemType="mediaCaption",c.addEventListener("dblclick",editListItem),n.addEventListener("click",previewListMedia)}o.focus(),o.addEventListener("keydown",s),o.addEventListener("blur",i)}function previewListMedia(e){let t=e.currentTarget.firstChild.getAttribute("src"),a=document.createElement("div");a.className="modal-overlay";let o=document.createElement("div");o.className="modal-overlay-close",o.id="modal-overlay-close",a.appendChild(o);let s=document.createElement("div");s.className="bookmark-media-preview",s.innerHTML='<iframe class="bookmark-iframe preview" src="'+t+'"></iframe>',a.appendChild(s),document.body.appendChild(a),a.addEventListener("click",e=>{let t=document.querySelector(".bookmark-media-preview");e.target!=t&&document.body.removeChild(a)})}function animateCSS(e,t,a){e.classList.add("animated",t),e.addEventListener("animationend",function o(){e.classList.remove("animated",t),e.removeEventListener("animationend",o),"function"==typeof a&&a()})}function addChecklist(e){let t=e.target.closest(".ad-card-div"),a=t.children[3];const o=document.createElement("div");o.className="bookmark-checklist",o.innerHTML='<span class="bookmark-checklist-toggler"><img src="/img/circle_unchecked.svg" class="bookmark-checklist-icon" alt=""></span><p class="bookmark-checklist-title">New checklist</p>',a.appendChild(o),o.itemType="checklist";let s=getNodeIndex(t);o.children[0].addEventListener("click",toggleChecked),a.scrollTop=a.scrollHeight,chrome.storage.local.get(["bookmarks"],function(e){e.bookmarks[s].listBookmarks.push({checklistTitle:"New checklist",isChecked:!1}),chrome.storage.local.set({bookmarks:e.bookmarks})}),o.children[1].itemType="checklistTitle",o.children[1].addEventListener("dblclick",editListItem),o.children[1].dispatchEvent(new Event("dblclick"))}function toggleChecked(e){const t=e.target,a=t.nextElementSibling;chrome.storage.local.get(["bookmarks","viewMode"],function(e){let o=getNodeIndex(t.parentElement.parentElement.parentElement),s=getNodeIndex(t.parentElement),i=!e.bookmarks[o].listBookmarks[s].isChecked;e.bookmarks[o].listBookmarks[s].isChecked=i,chrome.storage.local.set({bookmarks:e.bookmarks}),i?("dark"==e.viewMode?t.innerHTML='<img src="/img/circle_checked_dark.svg" class="bookmark-checklist-icon" alt="">':t.innerHTML='<img src="/img/circle_checked.svg" class="bookmark-checklist-icon" alt="">',a.classList.add("active")):("dark"==e.viewMode?t.innerHTML='<img src="/img/circle_unchecked_dark.svg" class="bookmark-checklist-icon" alt="">':t.innerHTML='<img src="/img/circle_unchecked.svg" class="bookmark-checklist-icon" alt="">',a.classList.remove("active")),chrome.storage.local.get(["autoDarkMode"],function(e){checkViewMode(e.autoDarkMode)})})}function shareBookmarksLinks(e){let t=getNodeIndex(e.to.parentElement),a=Number(e.clone.getAttribute("data-link"));chrome.storage.local.get(["currentWorkspaceId"],o=>{let s=document.querySelector(".workspace-open.active").parentNode.getAttribute("workspace_id");s==o.currentWorkspaceId?chrome.tabs.get(a,o=>{o?chrome.storage.local.get(["bookmarks"],function(s){let i=s.bookmarks[t].listBookmarks,n={};n.favIconUrl=o.favIconUrl,n.title=o.title,n.url=o.url,i.splice(e.newIndex,0,n),chrome.storage.local.set({bookmarks:s.bookmarks}),chrome.tabs.remove(a)}):(e.item.remove(),getBookmarks())}):switchWorkspace(s)})}function sortBookmarksLinks(e){let t=getNodeIndex(e.from.parentElement);chrome.storage.local.get(["bookmarks","currentWorkspaceId"],function(a){let o=document.querySelector(".workspace-open.active").parentNode.getAttribute("workspace_id");if(o==a.currentWorkspaceId){let o=a.bookmarks[t].listBookmarks;o[e.oldIndex]&&o.length==e.from.childElementCount?(arrayMove(o,e.oldIndex,e.newIndex),chrome.storage.local.set({bookmarks:a.bookmarks})):(e.item.remove(),getBookmarks())}else switchWorkspace(o)})}function moveBookmarksLinks(e){if("bookmark-share-list"!==e.from.id){let t=getNodeIndex(e.from.parentElement),a=getNodeIndex(e.to.parentElement);chrome.storage.local.get(["bookmarks","currentWorkspaceId"],function(o){let s=document.querySelector(".workspace-open.active").parentNode.getAttribute("workspace_id");if(s==o.currentWorkspaceId)if(o.bookmarks[t]&&o.bookmarks[a]){let s=o.bookmarks[t].listBookmarks,i=o.bookmarks[a].listBookmarks,n=o.bookmarks[t].listBookmarks[e.oldIndex];s[e.oldIndex]&&s.length!=e.from.childElementCount?(s.splice(e.oldIndex,1),i.splice(e.newIndex,0,n),chrome.storage.local.set({bookmarks:o.bookmarks})):(e.item.remove(),getBookmarks())}else e.item.remove(),getBookmarks();else switchWorkspace(s)})}}function removeBookmarksLinks(e){let t=getNodeIndex(e.from.parentElement);chrome.storage.local.get(["bookmarks","images","templateImages","currentWorkspaceId"],function(a){let o=document.querySelector(".workspace-open.active").parentNode.getAttribute("workspace_id");if(o==a.currentWorkspaceId){let o=a.bookmarks[t].listBookmarks,s=a.bookmarks[t].listBookmarks[e.oldIndex];o[e.oldIndex].url;o.length!=e.from.childElementCount?(o.splice(e.oldIndex,1),s.image&&!a.templateImages[s.image]&&(deleteImages({[s.image]:""}),delete a.images[s.image],chrome.storage.local.set({images:a.images})),chrome.storage.local.set({bookmarks:a.bookmarks})):e.item.remove()}else switchWorkspace(o)}),this.el.removeChild(e.item)}function showRemoveTooltip(){let e=event.target,t=event.x-124,a=event.y-52,o=document.createElement("div");o.className="remove-garbage-tooltip",o.setAttribute("tooltip","tooltip"),o.style.left=t+"px",o.style.top=a+"px",o.innerHTML="Drag&drop item here to delete";let s=e.parentElement.parentElement;function i(){"tooltip"!=event.target.getAttribute("tooltip")&&n()}function n(){s.removeEventListener("mouseleave",i),window.removeEventListener("click",n),o.remove()}e.parentElement.prepend(o),s.addEventListener("mouseleave",i),setTimeout(()=>{window.addEventListener("click",n)},50)}function moveBookmarksList(e){e.oldIndex!=e.newIndex&&chrome.storage.local.get(["bookmarks"],function(t){arrayMove(t.bookmarks,e.oldIndex,e.newIndex),chrome.storage.local.set({bookmarks:t.bookmarks})})}function arrayMove(e,t,a){return e.splice(a,0,e.splice(t,1)[0]),e}function openBookmarksListMenu(e){let t=e.currentTarget.parentElement,a=document.querySelectorAll(".bookmark-list-menu-container"),o=t.classList.contains("active");a.forEach(e=>{e.classList.remove("active")}),o||t.classList.add("active"),window.onclick=(e=>{e.target.matches(".bookmark-list-menu-open")||t.classList.remove("active")})}function openBookmarksList(e){let t=e.currentTarget.newWindow,a=e.currentTarget.parentElement.parentElement.parentElement,o=getNodeIndex(a);chrome.storage.local.get(["bookmarks","currentWorkspaceId","bookmarksListCount"],e=>{let s=document.querySelector(".workspace-open.active").parentNode.getAttribute("workspace_id");if(s==e.currentWorkspaceId){let s=e.bookmarks[o].listBookmarks,i=document.getElementById("bookmark-list-container").childElementCount,n=e.bookmarksListCount,r=a.getAttribute("data-id"),c=e.bookmarks[o].listId;if(i==n&&r==c)if(t){let e=[];s.forEach(t=>{t.url&&e.push(t.url)}),chrome.windows.create({url:e})}else s.forEach(e=>{e.url&&chrome.tabs.create({url:e.url,active:!1})});else getBookmarks()}else switchWorkspace(s)})}function duplicateBookmarksList(e){let t=e.currentTarget.parentElement.parentElement.parentElement,a=getNodeIndex(t),o=a+1;chrome.storage.local.get(["bookmarks","bookmarksListCount","images","bookmarksListCount","currentWorkspaceId"],e=>{let s=document.querySelector(".workspace-open.active").parentNode.getAttribute("workspace_id");if(s==e.currentWorkspaceId){let s=document.getElementById("bookmark-list-container").childElementCount,i=e.bookmarksListCount,n=t.getAttribute("data-id"),r=e.bookmarks[a].listId;if(s==i&&n==r){let t="bookmarks_list_"+(new Date).getTime(),s=e.bookmarks[a].listTitle,i=s,n=i.lastIndexOf(" (copy");if(-1==n)s=i+" (copy)";else if(i.length-n>10)s=i+" (copy)";else{let t=1;e.bookmarks.forEach(e=>{let a=e.listTitle.lastIndexOf(" (copy");if(-1!=a){e.listTitle.slice(0,a)==i.slice(0,a)&&t++}}),s=1==t?i+" (copy)":i.slice(0,n)+" (copy "+t+")"}let r=document.getElementById("bookmark-list-container"),c=r.children[a],l=c.cloneNode(!0);l.children[2].innerHTML=s,l.setAttribute("data-id",t),r.insertBefore(l,c.nextSibling),e.bookmarks=[...e.bookmarks.slice(0,a+1),{listBookmarks:e.bookmarks[a].listBookmarks,listTitle:s,listId:t},...e.bookmarks.slice(a+1)],chrome.storage.local.set({bookmarks:e.bookmarks},()=>{chrome.storage.local.get(["bookmarks"],t=>{t.bookmarks[o].listBookmarks.forEach((a,s)=>{if(a.image){let i="img_"+((new Date).getTime()+s);e.images[i]=e.images[a.image],t.bookmarks[o].listBookmarks[s]={image:i,caption:a.caption}}}),chrome.storage.local.set({bookmarksListCount:++e.bookmarksListCount}),chrome.storage.local.set({bookmarks:t.bookmarks,images:e.images}),addListeners()})})}else getBookmarks()}else switchWorkspace(s)})}function openToolsMenu(e){let t=e.currentTarget,a=e.currentTarget.parentElement.parentElement.children[0],o=document.querySelectorAll(".bookmark-tools-container"),s=e.currentTarget.parentElement.parentElement;s.addEventListener("mouseleave",function e(){s.removeEventListener("mouseleave",e);window.removeEventListener("click",n);r()});let i=a.classList.contains("active");function n(){window.removeEventListener("click",n),r()}function r(){a.classList.remove("active"),t.classList.remove("active"),t.addEventListener("click",openToolsMenu)}t.classList.add("active"),o.forEach(e=>{e.classList.remove("active")}),i||a.classList.add("active"),t.removeEventListener("click",openToolsMenu),setTimeout(()=>{window.addEventListener("click",n)},50)}function saveTemplate(e){let t=e.currentTarget.parentElement.parentElement.parentElement.getAttribute("data-id"),a=e.currentTarget.parentElement.parentElement.parentElement.childNodes[2].innerHTML;firebase.database().ref("/column_templates").once("value",function(e){e.exists()?chrome.storage.local.get(["bookmarks","images","workspaces","currentWorkspaceId"],e=>{const o=e.currentWorkspaceId,s=e.workspaces.findIndex((t,a)=>{if(e.workspaces[a].id==o)return 1}),i=e.workspaces[s].title;e.bookmarks.forEach(o=>{if(o.listId==t){let t={};o.listBookmarks.forEach(a=>{if(a.image){let o=base64toBlob(e.images[a.image],"image/png");const s=firebase.storage().ref().child("column_templates_images/"+a.image).put(o);s.on("state_changed",e=>{},e=>{},()=>{s.snapshot.ref.getDownloadURL().then(function(e){t[a.image]=e,db.ref("column_templates_images/"+a.image).set(t[a.image])})})}}),firebase.database().ref("column_templates/"+encodeURIComponent(i).replace(/\./g,"%2E")+"/"+encodeURIComponent(a).replace(/\./g,"%2E")).set(o.listBookmarks),chrome.storage.local.get(["templates"],e=>{let t=e.templates;t["User templates"][a]=o.listBookmarks,chrome.storage.local.set({templates:t})})}})}):console.log("DB error: cannot save the template")})}function removeBookmarksList(e){let t,a,o,s,i=e.currentTarget.parentElement.parentElement.parentElement,n=getNodeIndex(i),r=i.children[2].innerHTML,c={};chrome.storage.local.get(["bookmarks","currentWorkspaceId","images","backupImages","templateImages","bookmarksListCount"],e=>{let l=document.querySelector(".workspace-open.active").parentNode.getAttribute("workspace_id");if(l==e.currentWorkspaceId){let l=document.getElementById("bookmark-list-container").childElementCount,d=e.bookmarksListCount,m=i.getAttribute("data-id"),u=e.bookmarks[n].listId;if(l==d&&m==u){i.remove(),deleteImages(e.backupImages),chrome.storage.local.set({backupImages:{}},()=>{e.bookmarks[n].listBookmarks;t=e.bookmarks[n].listId,(a=e.bookmarks.splice(n,1))[0].listBookmarks.forEach(t=>{t.image&&!e.templateImages[t.image]&&(c[t.image]=e.images[t.image],delete e.images[t.image])}),chrome.storage.local.set({bookmarks:e.bookmarks}),chrome.storage.local.set({backupColumn:{listBookmarks:a[0].listBookmarks,listTitle:r,listId:t,indexColumn:n,idWorkspace:e.currentWorkspaceId}}),chrome.storage.local.set({images:e.images}),chrome.storage.local.set({backupImages:c}),chrome.storage.local.get(["bookmarksListCount"],function(e){e.bookmarksListCount--,0==e.bookmarksListCount&&getBlankPlaceholder(),chrome.storage.local.set({bookmarksListCount:e.bookmarksListCount})}),setBookmarksListWidth()}),document.querySelectorAll(".undo-popup-container").forEach(e=>{e.remove()});let l=document.createElement("div");l.className="undo-popup-container";let d='<div class="undo-popup">';d+='<div class="undo-popup-workspace">"<span class="undo-workspace">'+r+'</span>" <span class="undo-red">deleted</span></div>',d+='<div class="undo-popup-undo">Undo</div>',d+="</div>",l.innerHTML=d,document.body.append(l),animateCSS(l,"bounceInUp"),document.querySelector(".undo-popup-undo").addEventListener("click",()=>{l.remove(),o&&clearTimeout(o),s&&clearTimeout(s),chrome.storage.local.get(["images","backupImages"],e=>{for(image in c)e.images[image]=c[image];chrome.storage.local.set({images:e.images,backupImages:{}})}),chrome.storage.local.get(["bookmarks","backupColumn","bookmarksListCount","currentWorkspaceId","workspaces"],e=>{e.currentWorkspaceId==e.backupColumn.idWorkspace?(chrome.storage.local.set({bookmarks:[...e.bookmarks.slice(0,e.backupColumn.indexColumn),{listBookmarks:e.backupColumn.listBookmarks,listTitle:e.backupColumn.listTitle,listId:e.backupColumn.listId},...e.bookmarks.slice(e.backupColumn.indexColumn)]}),chrome.storage.local.set({bookmarksListCount:++e.bookmarksListCount}),restoreBookmark(e.backupColumn)):e.workspaces.forEach((t,a)=>{if(e.backupColumn.idWorkspace==t.id){t.bookmarks=[...t.bookmarks.slice(0,e.backupColumn.indexColumn),{listBookmarks:e.backupColumn.listBookmarks,listTitle:e.backupColumn.listTitle,listId:e.backupColumn.listId},...t.bookmarks.slice(e.backupColumn.indexColumn)];e.workspaces=[...e.workspaces.slice(0,a),t,...e.workspaces.slice(a+1)],chrome.storage.local.set({workspaces:e.workspaces},()=>{switchWorkspace(e.backupColumn.idWorkspace)})}})})}),o=setTimeout(()=>{animateCSS(l,"heartBeat"),s=setTimeout(()=>{l.remove(),deleteImages(c)},1e3)},5e3)}else getBookmarks()}else switchWorkspace(l)})}function deleteImages(e){chrome.storage.local.get(["templateImages"],t=>{let a=firebase.auth().currentUser;if(a)for(key in e)if(!t.templateImages[key]){firebase.storage().ref().child("user_images/"+a.uid+"/"+key).delete().then(function(){}).catch(function(e){})}})}function restoreBookmark(e){chrome.storage.local.get(["images","viewMode"],t=>{let a="";a+='<div class="bookmark-tools-container">',a+='<div class="bookmark-tools add-text"><span></span><p>Text</p></div>',a+='<div class="bookmark-tools add-header"><span></span><p>Subtitle</p></div>',a+='<div class="bookmark-tools add-checklist"><span></span><p>Checkbox</p></div>',a+='<div class="bookmark-tools add-link"><span></span><p>Link</p></div>',a+='<div class="bookmark-tools add-image"><span></span><p>Image</p></div>',a+='<div class="bookmark-tools add-quote"><span></span><p>Quote</p></div>',a+='<div class="bookmark-tools add-media"><span></span><p>Media (iframe)</p></div>',a+="</div>",a+='<div class="bookmark-list-menu-container">',a+='<div class="bookmark-list-menu-open"></div>',a+='<div class="bookmark-list-menu-items">',a+='<p class="bookmark-list-menu items open-current">Open links in current window</p>',a+='<p class="bookmark-list-menu items open-new">Open links in new window</p>',a+='<p class="bookmark-list-menu items open-duplicate">Duplicate column</p>',a+='<p class="bookmark-list-menu items remove-list">Delete column</p>',a+="</div>",a+="</div>",a+='<h1 class="bookmark-list-title contenteditable">'+e.listTitle+"</h1>",a+='<div class="bookmark-list-links put-tabs">',e.listBookmarks.forEach(e=>{if(e.header)a+='<p class="bookmark-capture">'+e.header+"</p>";else if(e.quote)a+='<div class="bookmark-quote"><div class="bookmark-quote-img"></div><div class="bookmark-quote-p">'+e.quote+"</div></div>";else if(e.text)a+='<div class="bookmark-text"><div class="bookmark-text-p">'+e.text+"</div></div>";else if(e.image)if("_none"==e.image){let t=(new Date).getTime();a+='<div class="bookmark-image undone"><input type="file" accept="image/*" class="bookmark-image-file" id="inp'+t+'"><label class="bookmark-image-content" for="inp'+t+'"><div class="image-cloud"></div><div class="image-drop">Drop file here</div><div class="image-jpg">JPG, GIF, PNG</div></label><div class="bookmark-image-caption">'+e.caption+"</div></div>"}else{let o=new Image,s=t.images[e.image];o.src="data:image/png;base64,"+s,a+='<div class="bookmark-image"><div class="bookmark-image-container"><img class="bookmark-image-img" src="'+o.src+'" alt=""></div><div class="bookmark-image-caption">'+e.caption+"</div></div>"}else if(e.url)a+='<div class="bookmark-container"><a href="'+e.url+'" class="bookmark-link"><div class="bookmark-favicon"><img src="'+e.favIconUrl+'" alt=""></div><p class="bookmark-title" title="'+e.title+'">'+e.title+"</p></a></div>";else if(e.checklistTitle){let o,s="";e.isChecked?(o="/img/circle_checked.svg","dark"==t.viewMode&&(o="/img/circle_checked_dark.svg"),s=" active"):(o="/img/circle_unchecked.svg","dark"==t.viewMode&&(o="/img/circle_unchecked_dark.svg")),a+='<div class="bookmark-checklist"><span class="bookmark-checklist-toggler"><img src="'+o+'" class="bookmark-checklist-icon" alt=""></span><p class="bookmark-checklist-title'+s+'">'+e.checklistTitle+"</p></div>"}else e.media&&(a+='<div class="bookmark-media"><div class="bookmark-media-content"><iframe class="bookmark-iframe" src="'+e.media+'"></iframe></div><div class="bookmark-media-caption">'+e.caption+"</div></div>")}),a+="</div>",a+='<div class="bookmark-link-menu-container">',a+='<div class="bookmark-link-menu tools"><span></span>Add item</div>',a+='<div class="bookmark-link-menu remove-link" title="Drag & drop item here to delete"></div>',a+="</div>";let o=document.getElementById("bookmark-list-container"),s=document.createElement("div");s.className="ad-card-div bookmarks",s.setAttribute("data-id",e.listId),o.insertBefore(s,o.children[e.indexColumn]);let i=document.getElementById("blank-placeholder");i&&i.remove(),s.innerHTML=a,setBookmarksListWidth(),s.style.opacity=1,addListeners()})}function getBlankPlaceholder(){firebase.auth().currentUser;chrome.storage.local.get(["workspaceTemplates"],e=>{let t="";for(key in t+='<div class="bookmark-list-blank-container">',t+='<div class="start-here-title">Start here &#11015;</div>',t+='<div class="start-here-text">Workspaces can be used to organize your workflow and share results</div>',t+='<div class="start-here-subtitle">Populate an example:</div>',e.workspaceTemplates)t+='<div class="workspace-template start-here-button">'+key+"</div>";t+='<div class="start-here-text">Create a new column and add links, notes, lists, images and iframes</div>',t+='<div class="start-here-subtitle">Create:</div>',t+='<div class="start-here-button blank">Blank column</div>',t+='<div class="start-here-button tabs">Column from open tabs</div>',t+='<div class="start-here-button template">Column using UX template</div>',t+="</div>";let a=document.createElement("div");a.className="ad-card-div blank",a.id="blank-placeholder",a.innerHTML=t,a.style.opacity=1,document.querySelector("#bookmark-list-container").appendChild(a),document.querySelector(".start-here-button.blank").addEventListener("click",()=>addBookmarksList()),document.querySelector(".start-here-button.tabs").addEventListener("click",()=>addBookmarksList(!0)),document.querySelector(".start-here-button.template").addEventListener("click",createNewColumn),document.querySelectorAll(".workspace-template").forEach(e=>e.addEventListener("click",addExampleWorkspace)),setBookmarksListWidth()})}function getNodeIndex(e){let t=e.parentNode.children,a=0;for(;a<t.length;a++)if(t[a]==e)return a}function addBookmarksList(e,t){let a=document.getElementById("blank-placeholder");a&&a.remove(),chrome.storage.local.get(["bookmarksListCount"],function(a){a.bookmarksListCount+=1;let o="bookmarks_list_"+(new Date).getTime(),s={listId:o};s.listTitle=e?"Open tabs":"Blank list";let i="";chrome.storage.local.set({bookmarksListCount:a.bookmarksListCount}),chrome.storage.local.get(["bookmarks","images","viewMode"],function(a){t?((s={listTitle:t.listTitle,listId:o,listBookmarks:t.listBookmarks}).listBookmarks.forEach(function(e){if(e.header)i+='<p class="bookmark-capture">'+e.header+"</p>";else if(e.url)i+='<div class="bookmark-container"><a href="'+e.url+'" class="bookmark-link"><div class="bookmark-favicon"><img src="'+e.favIconUrl+'" alt=""></div><p class="bookmark-title" title="'+e.title+'">'+e.title+"</p></a></div>";else if(e.text)i+='<div class="bookmark-text"><div class="bookmark-text-p">'+e.text+"</div></div>";else if(e.quote)i+='<div class="bookmark-quote"><div class="bookmark-quote-img"></div><div class="bookmark-quote-p">'+e.quote+"</div></div>";else if(e.image)if("_none"==e.image){let t=(new Date).getTime();i+='<div class="bookmark-image undone"><input type="file" accept="image/*" class="bookmark-image-file" id="inp'+t+'"><label class="bookmark-image-content" for="inp'+t+'"><div class="image-cloud"></div><div class="image-drop">Drop file here</div><div class="image-jpg">JPG, GIF, PNG</div></label><div class="bookmark-image-caption">'+e.caption+"</div></div>"}else{let t=new Image,o=a.images[e.image];t.src="data:image/png;base64,"+o,i+='<div class="bookmark-image"><div class="bookmark-image-container"><img class="bookmark-image-img" src="'+t.src+'" alt=""></div><div class="bookmark-image-caption">'+e.caption+"</div></div>"}else if(e.checklistTitle){let t,o="";e.isChecked?(t="/img/circle_checked.svg","dark"==a.viewMode&&(t="/img/circle_checked_dark.svg"),o=" active"):(t="/img/circle_unchecked.svg","dark"==a.viewMode&&(t="/img/circle_unchecked_dark.svg")),i+='<div class="bookmark-checklist"><span class="bookmark-checklist-toggler"><img src="'+t+'" class="bookmark-checklist-icon" alt=""></span><p class="bookmark-checklist-title'+o+'">'+e.checklistTitle+"</p></div>"}else e.media&&(i+='<div class="bookmark-media"><div class="bookmark-media-content"><iframe class="bookmark-iframe" src="'+e.media+'"></iframe></div><div class="bookmark-media-caption">'+e.caption+"</div></div>")}),a.bookmarks.push(s),chrome.storage.local.set({bookmarks:a.bookmarks})):e?chrome.tabs.query({active:!1,currentWindow:!0},e=>{let t=[{header:"Current open tabs"}];e.forEach((e,a)=>{t.push({favIconUrl:e.favIconUrl,title:e.title,url:e.url})}),s.listBookmarks=t,a.bookmarks.push(s),chrome.storage.local.set({bookmarks:a.bookmarks})}):(s.listBookmarks=[],a.bookmarks.push(s),chrome.storage.local.set({bookmarks:a.bookmarks}));const n=document.createElement("div");n.className="ad-card-div main-page bookmarks",n.setAttribute("data-id",o),n.style.opacity="1",n.innerHTML='<div class="bookmark-tools-container"><div class="bookmark-tools add-text"><span></span>Text</div><div class="bookmark-tools add-header"><span></span>Subtitle</div><div class="bookmark-tools add-checklist"><span></span>Checkbox</div><div class="bookmark-tools add-link"><span></span>Link</div><div class="bookmark-tools add-image"><span></span>Image</div><div class="bookmark-tools add-quote"><span></span>Quote</div><div class="bookmark-tools add-media"><span></span>Media (iframe)</div></div><div class="bookmark-list-menu-container"><div class="bookmark-list-menu-open"></div><div class="bookmark-list-menu-items"><p class="bookmark-list-menu items open-current">Open links in current window</p><p class="bookmark-list-menu items open-new">Open links in new window</p><p class="bookmark-list-menu items open-duplicate">Duplicate column</p><p class="bookmark-list-menu items remove-list">Delete column</p></div></div><h1 class="bookmark-list-title contenteditable">'+s.listTitle+'</h1><div class="bookmark-list-links put-tabs">'+getOpenTabs(e)+i+'</div><div class="bookmark-link-menu-container"><div class="bookmark-link-menu tools"><span></span>Add item</div><div class="bookmark-link-menu remove-link" title="Drag & drop item here to delete"></div></div></div>',document.getElementById("bookmark-list-container").appendChild(n),setBookmarksListWidth(),addListeners();let r=document.querySelector(".row.bookmarks");r.scrollLeft=r.scrollWidth,chrome.storage.local.get(["autoDarkMode"],function(e){checkViewMode(e.autoDarkMode)})})})}function createNewColumn(){ga("send","pageview","templates-open");let e=document.getElementById("create-new-column");function t(e){e.forEach(e=>{document.querySelectorAll(e).forEach(e=>e.classList.add("dark"))})}function a(){document.querySelector(".new-column-cover").remove(),document.querySelector(".new-column-modal").remove(),document.body.style.overflowY="",e.classList.remove("active")}e.classList.add("active"),chrome.storage.local.get(["templates","templatesDescriptions"],function(e){chrome.storage.local.get(["challenges"],function(o){chrome.storage.local.get(["viewMode"],function(s){chrome.storage.local.get(["autoDarkMode"],function(i){let n="";n+='<div class="new-column-modal-close-button"></div>',n+='<div class="new-column-modal-header new-column">Add new column</div>',n+='<div class="new-column-modal-category">',n+='<div class="new-column-add blank"><div class="new-column-icon"></div><div class="new-column-title">Blank</div></div>',n+='<div class="new-column-add open-tabs"><div class="new-column-icon"></div><div class="new-column-title">From<br>open tabs</div></div>',n+="</div>";let r=0;for(keyChallenge in o.challenges)r++;if(r>0){for(keyChallenge in n+='<div class="new-column-modal-header new-challenge"><span class="challenge-seedling">&#127793;</span> Product design challenge</div>',n+='<div class="challenge-info">You can use these templates as a reference for Product Design Challenge. <span class="challenge-info-link"><a href="https://productdesign.tips/a-product-design-challenge">Learn more</a></span></div>',n+='<div class="new-column-modal-category">',o.challenges)n+='<div class="new-column-add new-challenge" data-id1="Challenge" data-id2="'+keyChallenge+'"><div class="new-column-challenge"></div><div class="new-column-title">'+keyChallenge+'</div><div class="new-column-category">Challenge</div></div>';n+="</div>"}for(keyTitle in e.templates){for(keyTemplate in n+='<div class="new-column-modal-header">'+keyTitle+"</div>",e.templatesDescriptions[keyTitle]?n+='<div class="new-column-modal-description">'+e.templatesDescriptions[keyTitle]+"</div>":n+='<div class="new-column-modal-description"></div>',n+='<div class="new-column-modal-category">',e.templates[keyTitle])n+='<div class="new-column-add new-template" data-id1="'+keyTitle+'" data-id2="'+keyTemplate+'"><div class="new-column-template"></div><div class="new-column-title">'+keyTemplate+'</div><div class = "new-column-category">'+keyTitle+"</div></div>";n+="</div>"}n+='<div class="new-column-modal-header from-template"><div class="new-column-modal-line"></div></div>',n+='<div class="new-column-feedback"><span>What else we should add to templates?</span></div>';let c=[".new-column-cover",".new-column-modal",".new-column-modal-close-button",".new-column-modal-header",".new-column-add",".new-column-title",".new-column-category",".new-column-feedback",".new-column-modal-line"],l=(new Date).getHours();const d=document.createElement("div");d.className="new-column-cover",document.body.style.overflowY="hidden",document.body.prepend(d);const m=document.createElement("div");document.body.prepend(m),m.className="new-column-modal",m.innerHTML=n,"enabled"==i.autoDarkMode&&(l<=6||l>=21)&&t(c),"dark"==s.viewMode&&t(c),document.querySelector(".blank").addEventListener("click",()=>{a(),addBookmarksList()}),document.querySelector(".open-tabs").addEventListener("click",()=>{a(),addBookmarksList(!0)}),document.querySelector(".new-column-feedback").children[0].addEventListener("click",()=>{a(),openFeedback()}),document.querySelectorAll(".new-template").forEach(t=>t.addEventListener("click",function(t){const o=t.currentTarget.getAttribute("data-id1"),s=t.currentTarget.getAttribute("data-id2");for(keyTitle in e.templates)for(keyTemplate in e.templates[keyTitle])keyTitle==o&&keyTemplate==s&&(a(),addBookmarksList(!1,{listTitle:keyTemplate,listBookmarks:e.templates[keyTitle][keyTemplate]}))})),document.querySelectorAll(".new-challenge").forEach(e=>e.addEventListener("click",function(e){const t=e.currentTarget.getAttribute("data-id2");for(keyChallenge in o.challenges)keyChallenge==t&&(a(),addBookmarksList(!1,{listTitle:keyChallenge,listBookmarks:o.challenges[keyChallenge]}))})),document.querySelector(".new-column-modal-close-button").addEventListener("click",a),document.querySelector(".new-column-cover").addEventListener("click",a)})})})})}function openFeedback(){document.body.style.overflowY="hidden";const e=document.createElement("div");document.body.prepend(e),e.className="asidenav-nav-workspace-modal",e.innerHTML='<div class="asidenav-nav-workspace-modal-close"></div><div class="feedback-container"><iframe src="https://docs.google.com/forms/d/e/1FAIpQLScfOL8B2Kxt5g9Z0owQ1dQyodyXZmEO0X8M_WQFK94dGzRZqw/viewform?embedded=true"width="680" height="519" frameborder="0" marginheight="0" marginwidth="0">Loading…</iframe></div>',document.querySelector(".asidenav-nav-workspace-modal").addEventListener("click",function(){document.querySelector(".asidenav-nav-workspace-modal").remove(),document.body.style.overflowY=""})}function getOpenTabs(e){if(e){return document.getElementById("bookmark-share-list").cloneNode(!0).innerHTML}return""}function getCategories(e){ga("send","pageview","inspiration-open"),$(".container-fluid").removeClass("content"),chrome.storage.local.set({isWorkspaceOpen:!1}),document.getElementById("share-button").style.display="flex",document.body.style.height="auto",posts=temp_posts,category=e||temp_category,chrome.storage.local.get(["bookmarks"],e=>{for(var t='<div class="row" >',a=0;a<category_display&&!(a>=category.length);a++)if(4!=category[a].id){t+='<div class="ad-card-div main-page" id="'+category[a].id+'" style="background:linear-gradient(160deg, '+category[a].color1+", "+category[a].color2+')">',4!=category[a].id&&(~category[a].img_link.indexOf(".mp4")?(t+='<div class="image-card ad-card-2" style="opacity: 1;">',t+='<video class="card-video" playsinline="" muted="" autoplay="" loop="" src="'+category[a].img_link+'"></video>',t+='<a class="image-card-link" href="'+category[a].post_link+'"></a>',t+="</div>"):(t+='<div class="image-card ad-card-2" style="background-image: url('+category[a].img_link+')">',t+='<a class="image-card-link" href="'+category[a].post_link+'"></a>',t+="</div>"),t+='<div class="title-card ad-card-3">'),t+='<h1 class="title-h1">'+category[a].title+"</h1>";for(var o=0,s=0;s<posts.length;s++){if(posts[s].category_id==category[a].id){o++,t+='<div class="post-div'+checkIsItemInWorkspace(e,posts[s].link)+'">',t+='<div class="add-to-workspace"></div>';let i="https://www.google.com/s2/favicons?domain="+posts[s].link,n=posts[s].title;t+='<a class="post-link" href="'+posts[s].link+'" title="'+posts[s].title+'"><div class="post-link-url"><div class="bookmark-favicon"><img src="'+i+'" alt=""></div><div class="post-info"><p class="post-title workspace-title">'+n+'</p><p class="post-link post-origin">'+getsite(posts[s].link)+"</p></div></div></a>",t+="</div>",2==o&&4!=category[a].id&&(t+='<div class="post-hidden-layout">')}if(4==o){4!=category[a].id&&(t+="</div>");break}}o>=2&&o<4&&4!=category[a].id&&(t+="</div>"),4==category[a].id&&(t+='<a href="https://productdesign.tips/post-a-job"><div class="btn-post-a-job">Post a job</div></a>'),t+="</div>",t+="</div>"}else category_display++;if(t+="</div>",$("#main-content").html(t),document.getElementById("extension-message-container").classList.remove("style2"),document.getElementById("extension-message-container").classList.add("style1"),document.getElementById("asidenav").classList.contains("open")){let e=document.querySelectorAll(".ad-card-div");for(a=0;a<e.length;a++)e[a].classList.add("column"),a!=e.length/2-1&&a!=e.length-1||(e[a].style.display="none")}document.querySelectorAll(".add-to-workspace").forEach(e=>{e.addEventListener("click",checkWorkspace)}),$(".ad-card-div").each(function(){$(this).delay(getrandomdelay()).animate({opacity:"1"},100)}),$(".ad-card-2").each(function(){$(this).delay(getrandomdelay()).animate({opacity:"1"},100)}),$(".ad-card-3").each(function(){$(this).delay(getrandomdelay()).animate({opacity:"1"},100)}),$(".title-h1").click(function(){ccat_id=$(this).parent().parent().attr("id"),preloader(),$(".container-fluid").addClass("content"),getPostByCategory(ccat_id,getSectionsByCategory)}),rebuildAsideNavWorkspaces(),chrome.storage.local.get(["autoDarkMode"],function(e){checkViewMode(e.autoDarkMode)}),makeWorkspaceCounter("current"),activeItemAsideNav()})}function checkIsItemInWorkspace(e,t){let a=!1;return e.bookmarks.findIndex(e=>{if(e.listBookmarks.some(e=>e.url===t))return a=!0}),a?" added":""}function checkWorkspace(){let e=event.currentTarget,t=e.parentNode,a=getCategoryTitle(e),o=t.classList.toggle("added"),s={};s.url=e.nextElementSibling.getAttribute("href"),s.title=e.nextElementSibling.getAttribute("title"),s.favIconUrl="https://www.google.com/s2/favicons?domain="+s.url,chrome.storage.local.get(["bookmarks","currentWorkspaceId"],e=>{if(-1==e.currentWorkspaceId){let e=0,t=!0;openAsideNav(),checkToAddNewWorkspace(event,null,a,e,s,t)}else{let t=e.bookmarks.findIndex(e=>e.listTitle===a);if(o)if(-1===t){let t=e.bookmarks.length;addBookmarksListToStorage(e.bookmarks,a,t,s)}else addBookmarksLinkToStorage(e.bookmarks,t,s),makeWorkspaceCounter("next");else removeBookmarksLinkFromStorage(e.bookmarks,s.url),makeWorkspaceCounter("previous")}})}function getCategoryTitle(e){let t;switch(e.closest(".ad-card-div").id){case"7":case"8":case"9":case"10":case"11":t="Plan";break;case"6":case"12":case"13":case"14":case"15":case"16":t="Research";break;case"2":case"35":case"45":case"46":case"47":case"47":case"48":t="Ideate";break;case"3":case"5":case"17":case"18":case"19":case"20":case"21":case"22":case"36":t="Prototype";break;case"23":case"24":case"25":case"26":case"27":case"28":case"29":case"30":t="Design";break;case"12":case"31":case"33":case"34":case"37":t="Build";break;case"1":case"38":case"39":case"40":case"41":case"43":t="Career";break;default:console.log("category not found")}return t}function addBookmarksListToStorage(e,t,a,o,s){chrome.storage.local.get(["bookmarksListCount"],function(i){i.bookmarksListCount+=1;let n="bookmarks_list_"+i.bookmarksListCount;chrome.storage.local.set({bookmarksListCount:i.bookmarksListCount}),e.push({listBookmarks:[],listId:n,listTitle:t}),chrome.storage.local.set({bookmarks:e}),addBookmarksLinkToStorage(e,a,o),s||makeWorkspaceCounter("next")})}function addBookmarksLinkToStorage(e,t,a){e[t].listBookmarks.push({favIconUrl:a.favIconUrl,title:a.title,url:a.url}),chrome.storage.local.set({bookmarks:e})}function removeBookmarksLinkFromStorage(e,t){let a;e.forEach((e,o)=>{-1!==e.listBookmarks.findIndex(e=>e.url===t)&&(a=o)});let o=e[a].listBookmarks.findIndex(e=>e.url===t);e[a].listBookmarks.splice(o,1),chrome.storage.local.set({bookmarks:e})}function arrayRemove(e,t){return e.filter(function(e){return e!=t})}function workspaceMenuShow(){let e=firebase.auth().currentUser,t=event.currentTarget,a=t.parentNode;chrome.storage.local.get(["workspacesCount","paymentPlan"],o=>{let s;s=e&&o.workspacesCount>=5&&"free"==o.paymentPlan||!e&&o.workspacesCount>=1?" locked":" unlocked",t.classList.add("active"),t.style.display="flex";let i=document.createElement("div");i.className="workspace-menu-list-container";let n='<div class="workspace-menu-list" >';function r(){window.removeEventListener("click",r),c()}function c(){t.classList.remove("active"),t.style.display="",i.remove(),t.removeEventListener("click",c),t.addEventListener("click",workspaceMenuShow)}n+='<div class="workspace-menu-list-item edit">Edit name</div>',n+='<div class="workspace-menu-list-item duplicate'+s+'">Duplicate</div>',n+='<div class="workspace-menu-list-item delete">Delete workspace</div>',n+="</div>",i.innerHTML=n,a.appendChild(i),t.removeEventListener("click",workspaceMenuShow),document.querySelector(".workspace-menu-list-item.edit").addEventListener("click",()=>{editMenuItem(t.parentElement)}),e&&o.workspacesCount>=5&&"free"==o.paymentPlan?document.querySelector(".workspace-menu-list-item.duplicate").addEventListener("click",choosePlan):!e&&o.workspacesCount>=1?document.querySelector(".workspace-menu-list-item.duplicate").addEventListener("click",getLoginForm):document.querySelector(".workspace-menu-list-item.duplicate").addEventListener("click",()=>{checkToAddNewWorkspace(null,t.parentElement)}),document.querySelector(".workspace-menu-list-item.delete").addEventListener("click",()=>{deleteMenuItem(t.parentElement)}),setTimeout(()=>{window.addEventListener("click",r)},100)})}function addExampleWorkspace(){let e=event.target.innerHTML,t={};chrome.storage.local.get(["workspacesCount","workspaces","workspaceTemplates","currentWorkspaceId","bookmarks","bookmarksListCount"],a=>{for(key in a.workspaceTemplates)(key=e)&&(t=a.workspaceTemplates[key]);let o=a.currentWorkspaceId,s=a.workspaces.findIndex((e,t)=>{if(a.workspaces[t].id==o)return 1});a.bookmarks=t.bookmarks,a.bookmarksListCount=t.bookmarksListCount,a.workspaces[s].bookmarks=t.bookmarks,chrome.storage.local.set({bookmarks:a.bookmarks}),chrome.storage.local.set({bookmarksListCount:a.bookmarksListCount}),chrome.storage.local.set({workspaces:a.workspaces},()=>getBookmarks())})}function saveMenuItem(e){let t=e.children[0].innerHTML;firebase.database().ref("/column_templates").once("value",function(e){e.exists()?chrome.storage.local.get(["bookmarks","images","bookmarksListCount"],e=>{let a={};e.bookmarks.forEach(t=>{t.listBookmarks.forEach(t=>{if(t.image){let o=base64toBlob(e.images[t.image],"image/png");const s=firebase.storage().ref().child("column_templates_images/"+t.image).put(o);s.on("state_changed",e=>{},e=>{},()=>{s.snapshot.ref.getDownloadURL().then(function(e){a[t.image]=e,db.ref("column_templates_images/"+t.image).set(a[t.image])})})}})}),firebase.database().ref("workspace_templates/"+encodeURIComponent(t).replace(/\./g,"%2E")).set({bookmarks:e.bookmarks,bookmarksListCount:e.bookmarksListCount})}):console.log("DB error: cannot save the workspace")})}function deleteMenuItem(e){let t,a,o=e.getAttribute("workspace_id"),s=e.children[0].innerHTML,i={};function n(){document.querySelectorAll(".undo-popup-container").forEach(e=>{e.remove()});let e=document.createElement("div");e.className="undo-popup-container";let o='<div class="undo-popup">';o+='<div class="undo-popup-workspace">"<span class="undo-workspace">'+s+'</span>" <span class="undo-red">deleted</span></div>',o+='<div class="undo-popup-undo">Undo</div>',o+="</div>",e.innerHTML=o,document.body.append(e),animateCSS(e,"bounceInUp"),document.querySelector(".undo-popup-undo").addEventListener("click",()=>{e.remove(),t&&clearTimeout(t),a&&clearTimeout(a),chrome.storage.local.get(["images","backupImages"],e=>{for(image in i)e.images[image]=i[image];chrome.storage.local.set({images:e.images,backupImages:{}})}),chrome.storage.local.get(["workspaces","backupWorkspace","workspacesCount"],e=>{let t=[...e.workspaces.slice(0,e.backupWorkspace.index),e.backupWorkspace.workspace,...e.workspaces.slice(e.backupWorkspace.index)];chrome.storage.local.set({workspacesCount:++e.workspacesCount}),chrome.storage.local.set({workspaces:t}),switchWorkspace(e.backupWorkspace.workspace.id),addMenuListeners()})}),t=setTimeout(()=>{animateCSS(e,"heartBeat"),a=setTimeout(()=>{e.remove(),deleteImages(i)},1e3)},5e3)}makeWorkspaceCounter("reset",o),chrome.storage.local.get(["workspaces","currentWorkspaceId","workspacesCount","bookmarksListCount","isWorkspaceOpen","images","templateImages","backupImages"],e=>{let t;deleteImages(e.backupImages),chrome.storage.local.set({backupImages:{}},()=>{e.workspaces.forEach((a,s)=>{if(a.id==o)if(a.id==e.currentWorkspaceId){let o;chrome.storage.local.get(["bookmarks"],r=>{(t={bookmarks:r.bookmarks,bookmarksListCount:e.bookmarksListCount,id:a.id,title:a.title}).bookmarks.forEach(t=>{t.listBookmarks&&t.listBookmarks.forEach(t=>{t.image&&!e.templateImages[t.image]&&(i[t.image]=e.images[t.image],delete e.images[t.image])})}),-1!=(o=s>0?s-1:e.workspaces.length>1?s+1:-1)?(chrome.storage.local.set({currentWorkspaceId:e.workspaces[o].id}),chrome.storage.local.set({bookmarks:e.workspaces[o].bookmarks})):(chrome.storage.local.set({currentWorkspaceId:-1}),chrome.storage.local.set({bookmarks:[]}));let c=[...e.workspaces.slice(0,s),...e.workspaces.slice(s+1)];chrome.storage.local.set({workspaces:c}),chrome.storage.local.set({backupWorkspace:{workspace:t,index:s}}),chrome.storage.local.set({workspacesCount:--e.workspacesCount}),chrome.storage.local.set({images:e.images}),n(),e.isWorkspaceOpen&&e.workspacesCount>0&&getBookmarks(),rebuildAsideNavWorkspaces(),0==e.workspacesCount&&(chrome.storage.local.set({functionalMode:"articles"}),randomCategory(getCategories))})}else{(t=e.workspaces[s]).bookmarks.forEach(t=>{t.listBookmarks&&t.listBookmarks.forEach(t=>{t.image&&!e.templateImages[t.image]&&(i[t.image]=e.images[t.image],delete e.images[t.image])})});let a=[...e.workspaces.slice(0,s),...e.workspaces.slice(s+1)];chrome.storage.local.set({workspaces:a}),chrome.storage.local.set({backupWorkspace:{workspace:t,index:s}}),chrome.storage.local.set({workspacesCount:--e.workspacesCount}),chrome.storage.local.set({images:e.images}),n(),rebuildAsideNavWorkspaces()}})})})}function editMenuItem(e){let t=e.getAttribute("workspace_id");(e=e.children[0]).removeEventListener("click",switchWorkspace),e.removeEventListener("click",activeItemAsideNav);e.style.color;let a=e.innerHTML;function o(t){if(13===t.keyCode){addMenuListeners(),e.removeEventListener("keydown",o),e.removeEventListener("blur",s),e.removeEventListener("paste",i);let r=e.innerHTML;t.preventDefault(),e.setAttribute("contenteditable",!1),e.style.cursor="pointer",e.style.outline="",a!==r&&r.replace(/\s/g,"").length?n(r):e.innerHTML=a}else 27===t.keyCode&&(addMenuListeners(),e.removeEventListener("keydown",o),e.removeEventListener("blur",s),e.removeEventListener("paste",i),e.setAttribute("contenteditable",!1),e.innerHTML=a,e.style.cursor="pointer",e.style.outline="")}function s(t){addMenuListeners();let r=e.innerHTML;a!==r&&r.replace(/\s/g,"").length?n(r):(e.setAttribute("contenteditable",!1),e.innerHTML=a,e.style.cursor="pointer"),e.style.outline="",e.removeEventListener("keydown",o),e.removeEventListener("blur",s),e.removeEventListener("paste",i)}function i(e){e.preventDefault();let t=e.clipboardData.getData("text/plain");t=t.replace(/\</g,"&lt;").replace(/\>/g,"&gt;"),document.execCommand("insertHTML",!1,t)}function n(e){chrome.storage.local.get(["workspaces"],function(a){a.workspaces.forEach((o,s)=>{if(o.id==t){let t=o;t.title=e;let i=[...a.workspaces.slice(0,s),t,...a.workspaces.slice(s+1)];chrome.storage.local.set({workspaces:i})}})})}e.setAttribute("contenteditable",!0),e.focus(),e.style.cursor="auto",e.style.outline.overflow="visible",document.execCommand("selectAll",!1,null),e.addEventListener("keydown",o),e.addEventListener("blur",s),e.addEventListener("paste",i)}function switchWorkspace(e,t,a,o,s,i,n){let r;chrome.storage.local.set({isWorkspaceOpen:!0}),r=e.target?e.target.parentElement.getAttribute("workspace_id"):e,chrome.storage.local.get(["currentWorkspaceId"],e=>{chrome.storage.local.get(["workspaces"],a=>{-1==e.currentWorkspaceId?a.workspaces.forEach(e=>{e.id==r&&(chrome.storage.local.set({bookmarks:e.bookmarks}),chrome.storage.local.set({currentWorkspaceId:r}),chrome.storage.local.set({bookmarksListCount:e.bookmarksListCount}),rebuildAsideNavWorkspaces(t),makeWorkspaceCounter("reset"),getBookmarks())}):a.workspaces.forEach((o,s)=>{e.currentWorkspaceId==o.id&&chrome.storage.local.get(["bookmarks"],e=>{chrome.storage.local.get(["bookmarksListCount"],i=>{let n=[...a.workspaces.slice(0,s),{bookmarks:e.bookmarks,bookmarksListCount:i.bookmarksListCount,id:o.id,title:o.title},...a.workspaces.slice(s+1)];chrome.storage.local.set({workspaces:n},()=>{n.forEach(e=>{e.id==r&&(chrome.storage.local.set({bookmarks:e.bookmarks}),chrome.storage.local.set({currentWorkspaceId:r}),chrome.storage.local.set({bookmarksListCount:e.bookmarksListCount}),rebuildAsideNavWorkspaces(t),makeWorkspaceCounter("reset"),getBookmarks())})})})})})}),n&&addBookmarksListToStorage(a,o,s,i,n)})}function rebuildAsideNavWorkspaces(e){let t=firebase.auth().currentUser;chrome.storage.local.get(["workspaces","currentWorkspaceId","workspacesCount","functionalMode","workspaceBootmarksCounter","paymentPlan","isWorkspaceOpen"],a=>{const o=document.getElementById("dropdown-workspaces");o.innerHTML="";let s="",i=" unlocked";if(0==a.workspacesCount){const e=document.createElement("div");e.className="workspace-item-none",e.innerHTML="No workspaces",o.appendChild(e)}else a.workspaces.forEach((e,n)=>{(n>4&&"free"==a.paymentPlan||n>0&&!t)&&(i=" locked",e.id==a.currentWorkspaceId&&(a.isWorkspaceOpen?switchWorkspace(a.workspaces[0].id):(chrome.storage.local.set({currentWorkspaceId:a.workspaces[0].id}),chrome.storage.local.set({bookmarks:a.workspaces[0].bookmarks}))));const r=document.createElement("div");a.workspaceBootmarksCounter&&(s=a.workspaceBootmarksCounter[e.id]&&a.workspaceBootmarksCounter[e.id]>0?" new-add":""),r.className="workspace-item"+s+i,r.setAttribute("workspace_id",e.id),r.innerHTML='<p class="workspace-open asidenav-nav-dropdown-item'+i+'">'+e.title+'</p><span class="workspace-menu'+i+'"><span class="workspace-menu-icon'+i+'"></span></span>',o.appendChild(r)});if(a.isWorkspaceOpen){document.querySelector('div[workspace_id="'+a.currentWorkspaceId+'"]').firstChild.classList.add("active")}if("new workspace"==e){let e=document.querySelector(".dropdown-workspaces").lastChild;e.children[0].addEventListener("click",editMenuItem(e)),e.children[0].dispatchEvent(new Event("click"))}document.querySelectorAll(".asidenav-nav-dropdown-item").forEach(e=>{e.addEventListener("click",activeItemAsideNav)}),document.querySelectorAll(".asidenav-nav-dropdown-item.locked").forEach(e=>{e.removeEventListener("click",activeItemAsideNav)}),addMenuListeners()})}function checkToAddNewWorkspace(e,t,a,o,s,i){document.querySelector(".asidenav-nav-item.workspace").classList.contains("active")||toggleDropdown(null,"workspace");let n=firebase.auth().currentUser;function r(e){e.workspacesCount++,chrome.storage.local.set({workspacesCount:e.workspacesCount});const t="workspaces_list_"+(new Date).getTime(),n="New workspace "+e.workspacesCount;chrome.storage.local.get(["workspaces"],e=>{if(e.workspaces.push({bookmarks:[],bookmarksListCount:0,id:t,title:n}),chrome.storage.local.set({workspaces:e.workspaces}),i){switchWorkspace(t,"new workspace",[],a,o,s,i)}else switchWorkspace(t,"new workspace")})}function c(e){let t=e.getAttribute("workspace_id");chrome.storage.local.get(["workspaces","workspacesCount","bookmarks","currentWorkspaceId","bookmarksListCount","images"],e=>{let a=e.currentWorkspaceId,o=e.workspaces.findIndex((t,o)=>{if(e.workspaces[o].id==a)return 1});e.workspaces[o].bookmarks=e.bookmarks,e.workspaces[o].bookmarksListCount=e.bookmarksListCont,e.workspaces.forEach((a,o)=>{if(a.id==t){let t="workspaces_list_"+(new Date).getTime(),s=a.title,i=s,n=i.lastIndexOf(" (copy");if(-1==n)s=i+" (copy)";else if(i.length-n>10)s=i+" (copy)";else{let t=1;e.workspaces.forEach(e=>{let a=e.title.lastIndexOf(" (copy");if(-1!=a){e.title.slice(0,a)==i.slice(0,a)&&t++}}),s=1==t?i+" (copy)":i.slice(0,n)+" (copy "+t+")"}let r={bookmarks:a.bookmarks,bookmarksListCount:a.bookmarksListCount,id:t,title:s};r.bookmarks&&(r.bookmarks.forEach((t,a)=>{t.listBookmarks&&t.listBookmarks.forEach((t,o)=>{if(t.image){let s="img_"+((new Date).getTime()+100*a+o);e.images[s]=e.images[t.image],r.bookmarks[a].listBookmarks[o]={image:s,caption:t.caption}}})}),chrome.storage.local.set({images:e.images}));let c=[...e.workspaces.slice(0,o+1),r,...e.workspaces.slice(o+1)];chrome.storage.local.set({workspaces:c}),chrome.storage.local.set({workspacesCount:++e.workspacesCount}),rebuildAsideNavWorkspaces()}})})}chrome.storage.local.get(["workspacesCount"],e=>{n?db.ref("payments/"+n.uid+"/subscription").once("value",a=>{let o=a.val(),s=o.plan.plan_nickname,i=o.subscriptionStatus;chrome.storage.local.set({paymentPlan:s,subscriptionStatus:i}),e.workspacesCount>=5&&"free"==s?(choosePlan(),rebuildAsideNavWorkspaces()):t?c(t):r(e)}):e.workspacesCount>=1?getLoginForm():t?c(t):r(e)})}function toggleDropdown(e,t){let a;e?a=e.currentTarget:"workspace"==t?a=document.querySelector(".asidenav-nav-item.workspace"):"home"==t&&(a=document.querySelector(".asidenav-nav-item.active"));let o=document.querySelector(".asidenav-nav-icon-container.home"),s=document.querySelectorAll(".asidenav-nav-dropdown"),n=a.parentNode.querySelector(".asidenav-nav-dropdown"),r=n.querySelectorAll(".new-add");if("500px"==n.style.maxHeight)n.style.maxHeight="0",a.classList.remove("active"),$(".asidenav-img.items").removeClass("active"),$(".asidenav-nav-icon-container.items").removeClass("asidenav-close"),$(".asidenav-img.items").css("transform","scale(1,1)");else{for($(".asidenav-nav-dropdown").css("transition","max-height 0s"),i=0;i<s.length;i++)s[i].style.maxHeight="0";$(".asidenav-nav-dropdown-item").addClass("remove-transition"),$(".asidenav-nav-icon-container.items").removeClass("asidenav-close"),n.style.transition="max-height 0.2s",n.style.maxHeight="500px",$(r).removeClass("remove-transition"),$(".asidenav-nav-item").removeClass("active"),$(".asidenav-img.items").removeClass("active"),$(".asidenav-img.items").css("transform","scale(1,1)"),a.querySelector(".asidenav-nav-icon-container").classList.add("asidenav-close"),a.classList.add("active"),$(".asidenav-nav-item.active").find(".asidenav-img.items").addClass("active"),$(".asidenav-img.items.active").css("transform","scale(1,-1)")}o.classList.add("asidenav-close")}function toggleAsideNav(){event.target.classList.contains("asidenav-open")?openAsideNav():event.target.classList.contains("asidenav-close")&&closeAsideNav()}function openAsideNav(){let e=document.getElementById("asidenav"),t=document.querySelector(".asidenav-nav-icon-container.home");document.querySelectorAll(".asidenav-nav-icon-container.items").forEach(e=>{e.classList.remove("asidenav-open")}),e.classList.add("open"),t.classList.add("asidenav-close"),e.style.minWidth="320px",document.querySelector(".asidenav-container").style.width="320px",setTimeout(()=>{document.querySelectorAll(".asidenav-img-container").forEach(e=>{e.style.display="inline-flex"})},150),document.querySelectorAll(".asidenav-nav-item").forEach(e=>{e.style.pointerEvents="all"}),document.getElementById("settings-popup").style.left="320px";let a=document.querySelector(".ad-card-div").classList.contains("main-page"),o=document.querySelector(".row").classList.contains("bookmarks");if(a&&!o){let e=document.querySelectorAll(".ad-card-div");for(var s=0;s<e.length;s++)e[s].classList.add("column"),s!=e.length/2-1&&s!=e.length-1||(e[s].style.display="none")}}function closeAsideNav(){let e=document.getElementById("asidenav"),t=document.querySelectorAll(".asidenav-nav-icon-container.items");e.classList.remove("open"),t.forEach(e=>{e.classList.add("asidenav-open")});let a=document.querySelector(".ad-card-div").classList.contains("main-page"),o=document.querySelector(".asidenav-nav-icon-container.home"),s=document.querySelector(".asidenav-img-container.home");if(event.target==o||event.target==s){document.querySelectorAll(".asidenav-nav-dropdown").forEach(e=>{e.style.maxHeight="0"})}if(a){let e=document.querySelectorAll(".ad-card-div");for(var i=0;i<e.length;i++)e[i].classList.remove("column"),i!=e.length/2-1&&i!=e.length-1||(e[i].style.display="block")}e.style.minWidth="92px",document.querySelector(".asidenav-container").style.width="92px",setTimeout(()=>{document.querySelectorAll(".asidenav-img-container").forEach(e=>{e.style.display="none"})},100),document.querySelectorAll(".asidenav-nav-item").forEach(e=>{e.style.pointerEvents="none",e.classList.remove("active")}),document.getElementById("settings-popup").style.left="92px",document.querySelectorAll(".asidenav-nav-icon-container.items").forEach(e=>{e.classList.remove("asidenav-close")}),document.querySelectorAll(".asidenav-img.items").forEach(e=>{e.style.transform="scale(1,1)"})}function activeItemAsideNav(){document.querySelectorAll(".asidenav-nav-dropdown-item").forEach(e=>{e.classList.remove("active")}),event&&event.target.classList.add("active")}function getLoginForm(e){ga("send","pageview","login-popup");const t=document.createElement("div");let a,o,s,i,n,r,c,l,d;function m(){r.innerHTML='<img src="../img/circle.png">';let e=i.value,a=n.value;let o,c=new Date;o=c.getHours()>=9?new Date(c.getFullYear(),c.getMonth(),c.getDate()+1,9).getTime():new Date(c.getFullYear(),c.getMonth(),c.getDate(),9).getTime(),firebase.auth().createUserWithEmailAndPassword(e,a).then(a=>{s.classList.add("confirm"),s.innerHTML="Congratulations, you did it!",r.focus();let i=Date.now();chrome.storage.local.set({paymentPlan:"free",subscriptionStatus:"active",timestampBackup:i,freeBackup:o},()=>{db.ref("payments/").child(a.user.uid).set({customer_email:e,subscription:{firstSubscription:!0,status:"active",plan:{plan_nickname:"free"}}}),saveDataToDatabase(a.user.uid),setTimeout(()=>{t.remove(),choosePlan()},500),rebuildAsideNavWorkspaces()})}).catch(e=>{r.innerHTML="Sign up",s.classList.add("alarm"),s.innerHTML=e.message,n.value=""})}function u(){r.innerHTML='<img src="../img/circle.png">';let e=i.value,t=n.value;firebase.auth().signInWithEmailAndPassword(e,t).then(e=>{s.classList.add("confirm"),s.innerHTML="Congratulations, you did it!",r.focus(),db.ref("payments/"+e.user.uid+"/subscription").once("value",t=>{let a=t.val(),o=a.plan.plan_nickname,s=a.status;chrome.storage.local.set({paymentPlan:o,subscriptionStatus:s}),getDataFromDatabase(e.user.uid)}),setTimeout(popupClose,500),rebuildAsideNavWorkspaces()}).catch(function(e){r.innerHTML="Sign in",s.classList.add("alarm"),s.innerHTML=e.message,n.value=""})}function p(){var e=firebase.auth();r.innerHTML='<img src="../img/circle.png">';let t=i.value;e.sendPasswordResetEmail(t).then(function(){s.classList.add("confirm"),s.innerHTML="We emailed you a reset link.",r.focus(),setTimeout(popupClose,500)}).catch(function(e){r.innerHTML="Reset password",s.classList.add("alarm"),s.innerHTML=e.message})}function k(){o.removeEventListener("click",k),r.removeEventListener("click",m),n.removeEventListener("keydown",y),o.innerHTML="Create an account &#8594;",c.innerHTML="Sign In",s.classList.remove("alarm"),s.innerHTML="Authorize and backup your workspaces.",l.style.display="block",n.value="",n.style.display="block",r.innerHTML="Sign in",d.style.display="block",d.innerHTML="Forgot your password?",d.classList.toggle("reset"),o.addEventListener("click",g),r.addEventListener("click",u),n.addEventListener("keydown",b),d.addEventListener("click",v)}function g(){o.removeEventListener("click",g),r.removeEventListener("click",u),n.removeEventListener("keydown",b),o.innerHTML="I have an account. Sign In &#8594;",c.innerHTML="Create an account",s.classList.remove("alarm"),s.innerHTML="To get more workspaces and cloud backup.",n.value="",r.innerHTML="Sign Up",d.innerHTML='By signing up, I agree to <a href="https://productdesign.tips/html/terms-of-service" target="_blank">Terms of Service</a> and <a href="https://productdesign.tips/html/privacy-policy" target="_blank">Privacy Policy</a>.',d.classList.toggle("reset"),o.addEventListener("click",k),r.addEventListener("click",m),n.addEventListener("keydown",y)}function v(){o.removeEventListener("click",g),r.removeEventListener("click",u),i.removeEventListener("click",h),o.innerHTML="Back",c.innerHTML="Forgot your password?",s.innerHTML="We`ll help you reset it and get back on track.",l.style.display="none",n.value="",n.style.display="none",r.innerHTML="Reset password",d.classList.toggle("reset"),d.style.display="none",o.addEventListener("click",k),r.addEventListener("click",p),i.addEventListener("click",f)}function h(){13===event.keyCode&&""!=event.target.value&&n.focus()}function b(){13===event.keyCode&&u()}function y(){13===event.keyCode&&m()}function f(){13===event.keyCode&&p()}t.id="login-popup-container",t.className="modal-overlay-container login show",document.body.prepend(t),document.body.style.overflowY="hidden",a='<div class="popup-close login" id="popup-close"></div>',a+='<div class="login-popup">',a+='<div class="login-popup-image"><img src="../img/login_img_bg.svg" alt=""></div>',a+='<div class="login-popup-content">',a+='<div class="login-popup-switch-container"><p class="login-popup-switch" id="login-popup-switch">I have an account. Sign In &#8594;</p></div>',a+='<div class="login-popup-form-container">',a+='<h1 class="login-popup-form-container-h1">Create an account</h1>',a+='<p class="login-popup-form-error-message" id="login-popup-form-error-message">To get more workspaces and cloud backup.</p>',a+='<form class="login-popup-form">',a+='<label class="login-popup-label email" for="login-email">EMAIL</label>',a+='<input class="login-popup-input email" type="email" id="login-email" placeholder="Enter your email" required>',a+='<label class="login-popup-label pass" for="login-pass">PASSWORD</label>',a+='<input class="login-popup-input pass" type="password" id="login-pass" placeholder="Enter your password" required>',a+='<button type="button" class="login-popup-input button" id="login-submit">Sign up</button>',a+="</form>",a+='<p class="login-popup-form-info">By signing up, I agree to <a href="https://productdesign.tips/html/terms-of-service" target="_blank">Terms of Service</a> and <a href="https://productdesign.tips/html/privacy-policy" target="_blank">Privacy Policy</a>.</p>',a+="</div>",a+="</div>",a+="</div>",a+="</div>",t.innerHTML='<div class="popup-close login" id="popup-close"></div><div class="login-popup"><div class="login-popup-image"><img src="../img/login_img_bg.svg" alt=""></div><div class="login-popup-content"><div class="login-popup-switch-container"><p class="login-popup-switch" id="login-popup-switch">I have an account. Sign In &#8594;</p></div><div class="login-popup-form-container"><h1 class="login-popup-form-container-h1">Create an account</h1><p class="login-popup-form-error-message" id="login-popup-form-error-message">To get more workspaces and cloud backup.</p><form class="login-popup-form"><label class="login-popup-label email" for="login-email">EMAIL</label><input class="login-popup-input email" type="email" id="login-email" placeholder="Enter your email" required><label class="login-popup-label pass" for="login-pass">PASSWORD</label><input class="login-popup-input pass" type="password" id="login-pass" placeholder="Enter your password" required><button type="button" class="login-popup-input button" id="login-submit">Sign up</button></form><p class="login-popup-form-info">By signing up, I agree to <a href="https://productdesign.tips/html/terms-of-service" target="_blank">Terms of Service</a> and <a href="https://productdesign.tips/html/privacy-policy" target="_blank">Privacy Policy</a>.</p></div></div></div></div>',o=document.getElementById("login-popup-switch"),s=document.getElementById("login-popup-form-error-message"),i=document.getElementById("login-email"),n=document.getElementById("login-pass"),r=document.getElementById("login-submit"),c=document.querySelector(".login-popup-form-container-h1"),l=document.querySelector(".login-popup-label.pass"),d=document.querySelector(".login-popup-form-info"),r.addEventListener("click",m),o.addEventListener("click",k),i.addEventListener("keydown",h),n.addEventListener("keydown",y),t.addEventListener("click",popupClose)}async function choosePlan(){ga("send","pageview","subscription-popup");var e=firebase.auth().currentUser;let t,a=!1;const o=document.createElement("div");let s,i;o.id="plan-popup-container",o.className="modal-overlay-container plan show",document.body.prepend(o),document.body.style.overflowY="hidden",s='<div class="popup-close plan" id="popup-close"></div>',s+='<div class="plan-form-container">',s+='<div class="plan-title">Choose your plan</div>',s+='<div class="plan-label">Start to build an awesome products!</div>',s+='<div class="plan-categories">',s+='<div class="plan-image"></div>',s+='<div class="plan-container">',s+='<div class="plan-container-price-cover"><div class="plan-container-price disabled" id="starter-price">5</div></div>',s+='<div class="plan-container-title starter">STARTER</div>',s+='<div class="plan-container-advantages"><span class="plan-container-advantages-checked"></span>Backup once in 24h<span class="plan-container-advatages-question" data-descr="Backup once in 24h">?</span></div>',s+='<div class="plan-container-advantages"><span class="plan-container-advantages-checked"></span>5 projects</div>',s+='<div class="plan-container-advantages"><span class="plan-container-advantages-checked"></span>5 publication</div>',s+='<div class="plan-container-advantages disabled">Team members</div>',s+='<div class="plan-container-button starter">Choose starter</div>',s+="</div>",s+='<div class="plan-container">',s+='<div class="plan-container-price" id="pro-price">9.99</div>',s+='<div class="plan-container-title">PRO</div>',s+='<div class="plan-container-advantages"><span class="plan-container-advantages-checked"></span><span class="plan-container-advantages red">Immediate</span>backup <span class="plan-container-advatages-question" data-descr="Immediate backup">?</span></div>',s+='<div class="plan-container-advantages"><span class="plan-container-advantages-checked"></span><span class="plan-container-advantages red">Unlim</span>projects</div>',s+='<div class="plan-container-advantages"><span class="plan-container-advantages-checked"></span><span class="plan-container-advantages red">Unlim</span>publication</div>',s+='<div class="plan-container-advantages"><span class="plan-container-advantages-checked"></span>All upcoming features</div>',s+='<div class="plan-container-button pro" id="587096">Choose Pro</div>';await db.ref("payments/"+e.uid+"/subscription/firstSubscription").once("value",e=>{i=e.val()});i&&(s+='<div class="plan-container-offer pro" id="586907">Try it free for 14 days</div>'),s+="</div>",s+='<div class="plan-container">',s+='<div class="plan-container-price-team">Comming soon</div>',s+='<div class="plan-container-title">TEAM</div>',s+='<div class="plan-container-advantages"><span class="plan-container-advantages-checked"></span>Data backup<span class="plan-container-advatages-question" data-descr="Data backup">?</span></div>',s+='<div class="plan-container-advantages"><span class="plan-container-advantages-checked"></span>Unlim projects</div>',s+='<div class="plan-container-advantages"><span class="plan-container-advantages-checked"></span>Unlim publication</div>',s+='<div class="plan-container-advantages"><span class="plan-container-advantages-checked"></span>Team members</div>',s+='<div class="plan-container-button team"><a href="mailto:bogdan@productdesign.tips" target="_blank">Get quote</a></div>',s+='<div class="plan-container-offer-team">Contact us for more details</div>',s+="</div>",s+="</div>",s+='<div class="charge-yearly">Charge yearly. <span class="charge-yearly green">Save 15%</span>',s+='<div class="settings-popup-switch yearly">',s+='<label class="settings-popup-switch-label yearly">',s+='<input id="discount-switch" type="checkbox" checked>',s+='<span class="settings-popup-switch-slider yearly"></span>',s+="</label>",s+="</div>",s+="</div>",s+="</div>",o.innerHTML=s;let n=document.querySelector(".plan-container-button.starter"),r=document.querySelector(".plan-container-button.pro"),c=document.querySelector(".plan-container-offer.pro");function l(){ga("send","event","Subscription","click","Choose Plan"),preloaderUniversal.start();let t=event.target.id,a=e.email,o=e.uid;chrome.runtime.sendMessage({paddle:"create subscription",productId:t,email:a,uid:o},async e=>{})}n.addEventListener("click",function(){s='<div class="popup-close success" id="popup-close"></div>',s+='<div class="success-form-container">',s+='<div class="success-thanks">Thank you!</div>',s+='<div class="success-plan">You successfully subscribed to Starter plan!</div>',s+='<div class="sucess-image"></div>',s+="</div>",o.innerHTML=s}),r.addEventListener("click",l),i&&c.addEventListener("click",l),t=document.getElementById("discount-switch").addEventListener("click",()=>{(a=!!document.getElementById("discount-switch").checked)?(document.getElementById("pro-price").innerHTML="9.99",document.getElementById("starter-price").innerHTML="5",r.id="587096",c.id="586907"):(document.getElementById("pro-price").innerHTML="12",document.getElementById("starter-price").innerHTML="7",r.id="587095",c.id="586068")}),o.addEventListener("click",popupClose)}function popupClose(){let e=document.querySelector(".popup-close"),t=document.querySelector(".popup-close-inform"),a=document.querySelector(".modal-overlay-container");event&&event.target!=a&&event.target!=e&&event.currentTarget!=t||(document.querySelector(".modal-overlay-container").remove(),document.body.style.overflowY="")}function getAccountInfoForm(){let e,t=document.getElementById("main-content");document.getElementById("share-button").style.display="none";var a=firebase.auth().currentUser;function o(){const e=document.getElementById("account-save");let t=document.getElementById("account-email"),a=document.getElementById("account-pass-old"),o=document.getElementById("account-pass-new"),s=document.querySelector(".account-pass-error.old");if(s.classList.remove("alarm"),s.innerHTML="",s.style.transition="unset",s.style.opacity="1",t.value){var i=firebase.auth().currentUser;e.innerHTML='<img src="../img/circle.png">';let o=document.querySelector(".account-info-error");o.innerHTML="",o.style.transition="unset",o.style.opacity="1";var n=firebase.auth.EmailAuthProvider.credential(i.email,a.value);i.reauthenticateWithCredential(n).then(()=>{i.updateEmail(t.value).then(()=>{db.ref("payments/"+i.uid+"/customer_email").set(t.value),o.classList.remove("alarm"),o.innerHTML="Email changed",o.style.transition="opacity 0.5s ease-in-out 3s",o.style.opacity="0",document.querySelector(".asidenav-nav-p.login").innerHTML=t.value.split("@")[0],t.setAttribute("placeholder",t.value),a.value="",t.value="",e.innerHTML="<p>Save changes</p>"}).catch(t=>{o.classList.add("alarm"),o.innerHTML=t.message,o.style.transition="opacity 0.5s ease-in-out 3s",o.style.opacity="0",e.innerHTML="<p>Save changes</p>",a.value=""})}).catch(t=>{s.classList.add("alarm"),s.innerHTML=t.message,s.style.transition="opacity 0.5s ease-in-out 3s",s.style.opacity="0",a.value="",e.innerHTML="<p>Save changes</p>"})}if(o.value){i=firebase.auth().currentUser;e.innerHTML='<img src="../img/circle.png">';let t=document.querySelector(".account-pass-error.new");t.innerHTML="",t.style.transition="unset",t.style.opacity="1";n=firebase.auth.EmailAuthProvider.credential(i.email,a.value);i.reauthenticateWithCredential(n).then(()=>{i.updatePassword(o.value).then(()=>{t.classList.remove("alarm"),t.innerHTML="Password changed",t.style.transition="opacity 0.5s ease-in-out 3s",t.style.opacity="0",a.value="",o.value="",e.innerHTML="<p>Save changes</p>"}).catch(s=>{t.classList.add("alarm"),t.innerHTML=s.message,t.style.transition="opacity 0.5s ease-in-out 3s",t.style.opacity="0",o.value="",a.value="",e.innerHTML="<p>Save changes</p>"})}).catch(t=>{s.classList.add("alarm"),s.innerHTML=t.message,s.style.transition="opacity 0.5s ease-in-out 3s",s.style.opacity="0",o.value="",a.value="",e.innerHTML="<p>Save changes</p>"})}}document.body.style.height="auto",preloader(),t.classList.add("content"),db.ref("payments/"+a.uid).once("value",s=>{let i,n,r=s.val(),c=r.subscription.plan.plan_nickname,l=r.subscription.status;e=r.subscription.subscription_payment_id,chrome.storage.local.set({paymentPlan:c,subscriptionStatus:l});let d="";if(d+='<div class="row" style="padding:0 103px;">',d+='<div class="ad-card-div account" style="width:100%; height:100%;">',d+='<div class="account-page">',d+='<h1 class="account-h1 status">Subscription status</h1>',d+='<div class="account-status-container">',d+='<div class="account-status">',d+='<p class="account-status-p name"><span>'+c+"</span> plan</p>","free"==c&&"past_due"!=l)d+='<p class="account-status-p expire">Expiry date: Never</p>',d+='<p class="account-status-p button upgrade" id="account-actions">Upgrade</p>';else{let e=new Date(r.subscription.current_period_end);i=e.getDate()+" "+e.toLocaleString("default",{month:"long"})+", "+e.getFullYear(),n=r.subscription.subscription_id,d+='<p class="account-status-p expire">Expiry date: '+i+"</p>","deleted"!=l&&(d+='<p class="account-status-p button cancel" id="account-actions"><a href="'+r.subscription.cancel_subscription+'">Cancel subscription</a></p>',d+='<p class="account-status-p button update" id="account-update"><a href="'+r.subscription.update_subscription+'">Change payment method</a></p>')}if(d+="</div>",d+="</div>",d+="past_due"==l?'<p class="account-error">Payment was declined by your bank. Check your email and contact your bank for further information.</p>':'<p class="account-error"></p>',d+='<h1 class="account-h1 history">Order history</h1>',d+='<div class="account-history-container">',r.orders)for(prop in r.orders){let e=new Date(r.orders[prop].order_date),t=e.getDate()+" "+e.toLocaleString("default",{month:"long"})+", "+e.getFullYear();d+='<div class="account-history">',d+='<p class="account-history-p name"><span>'+r.orders[prop].opder_plan_nickname+"</span> account</p>",d+='<p class="account-history-p date">'+t+"</p>",d+='<p class="account-history-p receipt">Receipt: <span class="account-history-p button"><a href="'+r.orders[prop].order_receipt_url+'">HTML</a></span></p>',d+="</div>"}else d+='<div class="account-history">',d+='<p class="account-history-p empty">No orders yet</p>',d+="</div>";d+="</div>",d+='<h1 class="account-h1 info">Account info</h1>',d+='<div class="account-info-container">',d+='<label class="account-info-label">EMAIL</label>',d+='<input type="email" class="account-info-input email" id="account-email" placeholder="'+a.email+'">',d+='<p class="account-info-error"></p>',d+="</div>",d+='<h1 class="account-h1 pass">Change password</h1>',d+='<div class="account-pass-container">',d+='<label class="account-pass-label old">OLD PASSWORD</label>',d+='<input type="password" class="account-pass-input pass old" id="account-pass-old" placeholder="Enter old password">',d+='<p class="account-pass-error old"></p>',d+='<label class="account-pass-label new">NEW PASSWORD</label>',d+='<input type="password" class="account-pass-input pass new" id="account-pass-new" placeholder="Enter new password">',d+='<p class="account-pass-error new"></p>',d+="</div>",d+='<div class="account-bottom-container">',d+='<div class="account-bottom-save" id="account-save"><p>Save changes</p></div>',d+='<div class="account-bottom-signout" id="account-signout"><p>Sign Out</p></div>',d+="</div>",d+="</div>",d+="</div>",d+="</div>",document.getElementById("extension-message-container").classList.remove("style1"),document.getElementById("extension-message-container").classList.add("style2"),t.innerHTML=d,document.querySelector(".ad-card-div").style.opacity="1";let m=document.getElementById("account-actions");document.getElementById("account-save").addEventListener("click",o),document.getElementById("account-signout").addEventListener("click",loginSignOut),"free"==c&&m.addEventListener("click",choosePlan)})}function getContentPage(e){var t;document.body.style.height="auto",chrome.storage.local.set({isWorkspaceOpen:!1});for(var a,o=[],s=0;s<temp_category.length;s++)e==temp_category[s].id&&(t=temp_category[s]);a=postsByCategory,o=sectionsByCategory,chrome.storage.local.get(["bookmarks"],e=>{var s='<div class="row" style="padding:0 103px;">';s+='<div class="ad-card-div" id="'+t.id+'" style="width:100%; height:100%;">',s+='<div class="title-card ad-card-category" style="height:auto">',s+='<div id="categories-header" class="categories-header"></div>',$.get("./categories-header.html",function(e){$("#categories-header").empty(),$("#categories-header").append(e),$(".categories-header-h1").append(t.title),$(".categories-header-p").append(t.description),$(".categories-header-img").attr("src","../img/categories_header_bg_id_"+t.id+".png"),window.onscroll=function(){window.pageYOffset>=o?(a.classList.add("sticky"),$(".category-section.articles").css("margin-top","90px")):(a.classList.remove("sticky"),$(".category-section.articles").css("margin-top","0"))};var a=document.getElementById("categories-navigation-container"),o=a.offsetTop;$('a[href^="#"]').click(function(){var e=$(this).attr("href"),t=$(".categories-navigation").outerHeight();return $("html, body").animate({scrollTop:$(e).offset().top-t},0),!1}),sectionsByCategory&&getSectionsMenuItems()}),s+='<section id="categories-articles" class="category-section articles">',s+='<div class="category-section-header">',s+='<h3 class="category-section-title articles">Articles</h3>',s+='<div class="show-post-div articles" id="show-post-div">Show all <span> ('+a.length+")</span></div>",s+='<div class="hide-post-div articles" id="hide-post-div">Show less</div>',s+="</div>";for(var i=0;i<a.length;i++)if(a[i].category_id==t.id){s+='<div class="categories-post-div'+checkIsItemInWorkspace(e,a[i].link)+'">',s+='<div class="add-to-workspace"></div>',s+='<a class="categories-post-link" href="'+a[i].link+'" title="'+a[i].title+'"><p class="categories-post-title workspace-title">'+a[i].title+'</p><p class="categories-post-origin">'+getsite(a[i].link)+"</p></a>",s+="</div>"}switch(s+="</section>",s+='<div id="category-other-content">',o&&(o.books&&($(".categories-navigation-button.books").css("display","none"),o.books.reverse().sort(function(e,t){return e.featured===t.featured?0:e.featured?-1:1}),s+='<section id="categories-books" class="category-section books">',s+='<div class="category-section-header">',s+='<h3 class="category-section-title books">Books</h3>',s+='<div class="show-post-div books" id="show-books">Show all <span> ('+t.sections.books.length+")</span></div>",s+='<div class="hide-post-div books" id="hide-books">Show less</div>',s+="</div>",s+='<div class="category-section-container books">',s+="</div>",s+="</section>"),o.podcasts&&(o.podcasts.reverse().sort(function(e,t){return e.featured===t.featured?0:e.featured?-1:1}),s+='<section id="categories-podcasts" class="category-section podcasts">',s+='<div class="category-section-header">',s+='<h3 class="category-section-title podcasts">Podcasts</h3>',s+='<div class="show-post-div podcasts" id="show-podcasts">Show all <span> ('+t.sections.podcasts.length+")</span></div>",s+='<div class="hide-post-div podcasts" id="hide-podcasts">Show less</div>',s+="</div>",s+='<div class="category-section-container podcasts">',s+="</div>",s+="</section>"),o.videos&&(o.videos.reverse().sort(function(e,t){return e.featured===t.featured?0:e.featured?-1:1}),s+='<section id="categories-videos" class="category-section videos">',s+='<div class="category-section-header">',s+='<h3 class="category-section-title videos">Videos</h3>',s+='<div class="show-post-div videos" id="show-videos">Show all <span> ('+o.videos.length+")</span></div>",s+='<div class="hide-post-div videos" id="hide-videos">Show less</div>',s+="</div>",s+='<div class="category-section-container videos">',s+="</div>",s+="</section>"),o.courses&&(o.courses.reverse().sort(function(e,t){return e.featured===t.featured?0:e.featured?-1:1}),s+='<section id="categories-courses" class="category-section courses">',s+='<div class="category-section-header">',s+='<h3 class="category-section-title courses">Courses</h3>',s+='<div class="show-post-div courses" id="show-courses">Show all <span> ('+o.courses.length+")</span></div>",s+='<div class="hide-post-div courses" id="hide-courses">Show less</div>',s+="</div>",s+='<div class="category-section-container courses">',s+="</div>",s+="</section>"),o.community&&(o.community.reverse().sort(function(e,t){return e.featured===t.featured?0:e.featured?-1:1}),s+='<section id="categories-community" class="category-section community">',s+='<div class="category-section-header">',s+='<h3 class="category-section-title community">Community</h3>',s+='<div class="show-post-div community" id="show-community">Show all <span> ('+o.community.length+")</span></div>",s+='<div class="hide-post-div community" id="hide-community">Show less</div>',s+="</div>",s+='<div class="category-section-container community">',s+="</div>",s+="</section>"),o.tools&&(o.tools.reverse().sort(function(e,t){return e.featured===t.featured?0:e.featured?-1:1}),s+='<section id="categories-tools" class="category-section tools">',s+='<div class="category-section-header">',s+='<h3 class="category-section-title tools">Tools</h3>',s+='<div class="show-post-div tools" id="show-tools">Show all <span> ('+o.tools.length+")</span></div>",s+='<div class="hide-post-div tools" id="hide-tools">Show less</div>',s+="</div>",s+='<div class="category-section-container tools">',s+="</div>",s+="</section>"),o.people&&(o.people.reverse().sort(function(e,t){return e.featured===t.featured?0:e.featured?-1:1}),s+='<section id="categories-people" class="category-section people">',s+='<div class="category-section-header">',s+='<h3 class="category-section-title people">People</h3>',s+='<div class="show-post-div people" id="show-people">Show all <span> ('+o.people.length+")</span></div>",s+='<div class="hide-post-div people" id="hide-people">Show less</div>',s+="</div>",s+='<div class="category-section-container people">',s+="</div>",s+="</section>")),s+="</div>",t.id){case"1":page_name="about-product-design";break;case"2":page_name="design-thinking";break;case"3":page_name="usability-and-accessibility";break;case"4":page_name="jobs";break;case"5":page_name="design-ethics";break;case"6":page_name="ux-and-psychology";break;case"7":page_name="product-strategy";break;case"8":page_name="leadership-and-teamwork";break;case"9":page_name="design-process";break;case"10":page_name="product-metrics";break;case"11":page_name="product-growth";break;case"12":page_name="user-research-methods";break;case"13":page_name="recruiting-for-user-research";break;case"14":page_name="user-research-on-practice";break;case"15":page_name="user-research-tools";break;case"16":page_name="user-research-deliverables";break;case"17":page_name="responsive-design-guides";break;case"18":page_name="mobile-apps-design-guides";break;case"19":page_name="vr-ar-design-guides";break;case"20":page_name="voice-and-chat-design-guides";break;case"21":page_name="wearables-and-iot-design-guides";break;case"22":page_name="ui-design-guides";break;case"23":page_name="ui-design-tools";break;case"24":page_name="ui-design-plugins-and-helpers";break;case"25":page_name="ui-patterns-and-kits";break;case"26":page_name="design-systems";break;case"27":page_name="color-palettes-and-tools";break;case"28":page_name="icons-and-fonts";break;case"29":page_name="visual-assets";break;case"30":page_name="ui-interactions-and-motion";break;case"31":page_name="handoff-tools";break;case"32":page_name="handoff-process";break;case"33":page_name="css-and-js-hacks";break;case"34":page_name="ai-and-design-algorithms";break;case"35":page_name="ideas-validation";break;case"36":page_name="prototype-testing";break;case"37":page_name="product-validation";break;case"38":page_name="case-studies";break;case"39":page_name="how-to-present-your-work";break;case"40":page_name="challenges-and-exercises";break;case"41":page_name="career-growth";break;case"42":page_name="product-events";break;case"43":page_name="portfolios-and-interviews";break;case"44":page_name="discussion-groups";break;case"45":page_name="problem-solving";break;case"46":page_name="user-flow";break;case"47":page_name="information-architecture";break;case"48":page_name="ux-writing";break;default:console.log("page name not matched with any result")}if(s+="</div>",s+="</div>",s+="</div>",document.getElementById("extension-message-container").classList.remove("style1"),document.getElementById("extension-message-container").classList.add("style2"),$("#main-content").html(s),ga("send","pageview","/categories/"+page_name),o){if(o.books){$(".categories-navigation-button.books").css("display","none");var n=calcSectionItemsQty("books");n<o.books.length&&$("#show-books").show(),getBooks(o.books,n,!0,e)}if(o.podcasts){var r=calcSectionItemsQty("podcasts");r<o.podcasts.length&&$("#show-podcasts").show(),getPodcasts(o.podcasts,r,!0,e)}if(o.videos){var c=calcSectionItemsQty("videos");c<o.videos.length&&$("#show-videos").show(),getVideos(o.videos,c,!0,e)}if(o.courses){var l=calcSectionItemsQty("courses");l<o.courses.length&&$("#show-courses").show(),getCourses(o.courses,l,!0,e)}if(o.community){var d=calcSectionItemsQty("community");d<o.community.length&&$("#show-community").show(),getCommunity(o.community,d,!0,e)}if(o.tools){var m=calcSectionItemsQty("tools");m<o.tools.length&&$("#show-tools").show(),getTools(o.tools,m,!0,e)}if(o.people){var u=calcSectionItemsQty("people");u<o.people.length&&$("#show-people").show(),getPeople(o.people,u,!0)}}$(".show-post-div").click(function(){$(this).hasClass("books")?(showSectionRestItems("books"),o.books.length!=$(".category-section-body.books").length&&getBooks(o.books,n,!1,e)):$(this).hasClass("podcasts")?(showSectionRestItems("podcasts"),o.podcasts.length!=$(".category-section-body.podcasts").length&&getPodcasts(o.podcasts,r,!1,e)):$(this).hasClass("videos")?(showSectionRestItems("videos"),o.videos.length!=$(".category-section-body.videos").length&&getVideos(o.videos,c,!1,e)):$(this).hasClass("courses")?(showSectionRestItems("courses"),o.courses.length!=$(".category-section-body.courses").length&&getCourses(o.courses,l,!1,e)):$(this).hasClass("community")?(showSectionRestItems("community"),o.community.length!=$(".category-section-body.community").length&&getCommunity(o.community,d,!1,e)):$(this).hasClass("tools")?(showSectionRestItems("tools"),o.tools.length!=$(".category-section-body.tools").length&&getTools(o.tools,m,!1,e)):$(this).hasClass("people")&&(showSectionRestItems("people"),o.people.length!=$(".category-section-body.people").length&&getPeople(o.people,u,!1))}),$(".hide-post-div").click(function(){$(this).hasClass("books")?hideSectionRestItems("books"):$(this).hasClass("podcasts")?hideSectionRestItems("podcasts"):$(this).hasClass("videos")?hideSectionRestItems("videos"):$(this).hasClass("courses")?hideSectionRestItems("courses"):$(this).hasClass("community")?hideSectionRestItems("community"):$(this).hasClass("tools")?hideSectionRestItems("tools"):$(this).hasClass("people")&&hideSectionRestItems("people")}),$(".ad-card-div").each(function(){$(this).animate({opacity:"1"},100)}),$(".ad-card-category").each(function(){$(this).animate({opacity:"1"},100)}),document.querySelectorAll(".add-to-workspace").forEach(e=>{e.addEventListener("click",checkWorkspace)})})}function calcSectionItemsQty(e){if("books"==e)var t=176;else if("podcasts"==e)t=344;else if("videos"==e)t=344;else if("courses"==e)t=344;else if("community"==e)t=258;else if("tools"==e)t=172;else if("people"==e)t=258;let a=$(".category-section-container."+e).width();return Math.trunc(a/t)}function showSectionRestItems(e){$("#show-"+e).hide(),$("#hide-"+e).show(),$(".category-section-container."+e).css("max-height","5000px")}function hideSectionRestItems(e){$("#hide-"+e).hide(),$("#show-"+e).show(),$(".category-section-container."+e).css("max-height","")}function getBooks(e,t,a,o){let s=[];if(a)var i=e.slice(0,t);else i=e.slice(t);i.forEach(function(e,t,a){let i=checkIsItemInWorkspace(o,e.link);e.featured?s+='<div class="category-section-body books featured'+i+'">':s+='<div class="category-section-body books'+i+'">',s+='<div class="add-to-workspace"></div>',s+='<a href="'+e.link+'" target="_blank">',s+='<p class="category-section-name books workspace-title">'+e.title+"</p>",s+='<div class="category-section-img-container books">',s+='<img src="'+e.cover+'">',s+="</div>",s+="</a>",s+="</div>"}),$(".category-section-container.books").append(s)}function getPodcasts(e,t,a,o){let s=[];if(a)var i=e.slice(0,t);else i=e.slice(t);i.forEach(function(e,t,a){let i=checkIsItemInWorkspace(o,e.link);e.featured?s+='<div class="category-section-body podcasts featured'+i+'">':s+='<div class="category-section-body podcasts'+i+'">',s+='<div class="add-to-workspace"></div>',s+='<a href="'+e.link+'" target="_blank">',s+='<div class="category-section-img-container podcasts">',s+='<img src="'+e.cover+'">',s+="</div>",s+='<div class="category-section-info podcasts">',s+='<p class="category-section-source podcasts">'+e.source+"</p>",s+='<p class="category-section-name podcasts workspace-title">'+e.title+"</p>",s+="</div>",s+="</a>",s+="</div>"}),$(".category-section-container.podcasts").append(s)}function getVideos(e,t,a,o){let s=[];if(a)var i=e.slice(0,t);else i=e.slice(t);i.forEach(function(e,t,a){let i=checkIsItemInWorkspace(o,e.link);e.featured?s+='<div class="category-section-body videos featured'+i+'">':s+='<div class="category-section-body videos'+i+'">',s+='<div class="add-to-workspace"></div>',s+='<iframe class="category-section-player videos" src="https://www.youtube.com/embed/'+e.link+'" allow="fullscreen"></iframe>',s+='<div class="category-section-info videos">',s+='<a href="https://www.youtube.com/watch?v='+e.link+'" target="_blank">',s+='<p class="category-section-name videos workspace-title">'+e.title+"</p>",s+='<p class="category-section-source videos">'+e.source+"</p>",s+="</a>",s+="</div>",s+="</div>"}),$(".category-section-container.videos").append(s)}function getCourses(e,t,a,o){let s=[];if(a)var i=e.slice(0,t);else i=e.slice(t);i.forEach(function(e,t,a){let i=checkIsItemInWorkspace(o,e.link);e.featured?s+='<div class="category-section-body courses featured'+i+'">':s+='<div class="category-section-body courses'+i+'">',s+='<div class="add-to-workspace"></div>',s+='<a href="'+e.link+'" target="_blank">',s+='<div class="category-section-img-container courses">',s+='<img class="style1" src="'+e.cover+'">',s+="</div>",s+='<div class="category-section-info courses">',s+='<p class="category-section-name courses workspace-title">'+e.title+"</p>",s+='<p class="category-section-source courses">'+e.source+"</p>",s+="</div>",s+="</a>",s+="</div>"}),$(".category-section-container.courses").append(s)}function getCommunity(e,t,a,o){let s=[];if(a)var i=e.slice(0,t);else i=e.slice(t);i.forEach(function(e,t,a){let i=checkIsItemInWorkspace(o,e.link);e.featured?s+='<div class="category-section-body community featured'+i+'">':s+='<div class="category-section-body community'+i+'">',s+='<div class="add-to-workspace"></div>',s+='<a href="'+e.link+'" target="_blank">',s+='<div class="category-section-img-container community">',s+='<img class="style1" src="'+e.cover+'">',s+="</div>",s+='<div class="category-section-info community">',s+='<p class="category-section-source community">'+e.source+"</p>",s+='<p class="category-section-name community workspace-title">'+e.title+"</p>",s+="</div>",s+="</a>",s+="</div>"}),$(".category-section-container.community").append(s)}function getTools(e,t,a,o){let s=[];if(a)var i=e.slice(0,t);else i=e.slice(t);i.forEach(function(e,t,a){let i=checkIsItemInWorkspace(o,e.link);e.featured?s+='<div class="category-section-body tools featured'+i+'">':s+='<div class="category-section-body tools'+i+'">',s+='<div class="add-to-workspace"></div>',s+='<a href="'+e.link+'" target="_blank">',s+='<div class="category-section-img-container tools">',s+='<img class="style1" src="https://www.google.com/s2/favicons?domain='+e.link+'">',s+="</div>",s+='<div class="category-section-info tools">',s+='<p class="category-section-name tools workspace-title">'+e.title+"</p>",s+='<p class="category-section-source tools">'+e.source+"</p>",s+="</div>",s+="</a>",s+="</div>"}),$(".category-section-container.tools").append(s),document.querySelectorAll(".category-section-body.tools a").forEach(e=>{getLinkPreviewImage(e)})}function getPeople(e,t,a){let o=[];if(a)var s=e.slice(0,t);else s=e.slice(t);s.forEach(function(e,t,a){e.featured?o+='<div class="category-section-body people featured">':o+='<div class="category-section-body people">',o+='<div class="category-section-img-container people">',o+='<img class="style1" src="'+e.cover+'">',o+="</div>",o+='<div class="category-section-info people">',o+='<p class="category-section-name people workspace-title">'+e.title+"</p>",o+='<p class="category-section-source people">'+e.source+"</p>",o+="</div>",o+='<div class="category-section-links-container people">',Object.keys(e.link).forEach(t=>{o+='<div class="category-section-links '+t+'">',o+='<a href="'+e.link[t]+'" target="_blank">',o+='<img class="category-section-links-img" src="../img/icon_'+t+'_s.svg">',o+="</a>",o+="</div>"}),o+="</div>",o+="</div>"}),$(".category-section-container.people").append(o)}function formatDate(e){var t=e.split("-")[2],a=Number(e.split("-")[1]),o=e.split("-")[0];return t+" "+["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"][a-1]+" "+o}function viewMode(e){chrome.storage.local.get(["colorInspiration"],t=>{"normal"==e?($("body").css("background","#F7F7FB"),$(".asidenav").css("background","#F7F7FB"),$(".categories-navigation-container").removeClass("dark"),$(".categories-navigation").removeClass("dark"),$(".container-fluid").removeClass("dark"),$(".container-fluid").removeClass("less"),$(".container-fluid").addClass("normal"),$("#extension-message-container").removeClass("dark"),$("#extension-message-container").addClass("less"),$(".share-container").removeClass("dark"),$(".share-button").css({background:"#FFFFFF",border:"1px solid #E8E8E8"}),$(".share-button").children("svg").children("path").css("stroke","#278CCA"),$(".share-button-text").css("color","#278CCA"),$(".ad-card-div.main-page").each(function(){$(this).css("background","linear-gradient(160deg, "+category_color[$(this).attr("id")].color1+", "+category_color[$(this).attr("id")].color2+")")}),$(".ad-card-div.share-tabs").css("background","none"),$(".ad-card-2").css("filter","none"),$(".title-h1").css("color","#FFFFFF"),$(".title-h1").removeClass("less"),$(".post-title").css("color","#FFFFFF"),$(".post-link").css("color","rgba(255,255,255,0.8)"),$(".asidenav-nav-bottom").removeClass("dark"),$(".asidenav-nav-bottom").removeClass("less"),$(".asidenav-nav-bottom").addClass("normal"),$(".asidenav-nav").removeClass("dark"),$(".asidenav-nav").addClass("normal"),$(".asidenav-nav-icon-container.style1").css("background","#FFFFFF"),$(".asidenav-nav-icon-container.style2.item1").css("background","rgba(128, 188, 107, 0.17)"),$(".asidenav-nav-icon-container.style2.item2").css("background","rgba(87, 177, 189, 0.17)"),$(".asidenav-nav-icon-container.style2.item3").css("background","rgba(101, 177, 232, 0.17)"),$(".asidenav-nav-icon-container.style2.item4").css("background","rgba(74, 135, 226, 0.17)"),$(".asidenav-nav-icon-container.style2.item5").css("background","rgba(101, 122, 237, 0.17)"),$(".asidenav-nav-icon-container.style2.item6").css("background","rgba(138, 107, 226, 0.17)"),$(".asidenav-nav-icon-container.style2.item7").css("background","rgba(208, 100, 119, 0.17)"),$(".asidenav-nav-icon-container.style2.challenges").css("background","rgba(87, 188, 136, 0.17)"),$(".asidenav-nav-icon").attr("src",function(e,t){return t.replace("dark","color")}),$(".asidenav-nav-item").removeClass("dark"),$(".asidenav-nav-dropdown-item").removeClass("dark"),$(".settings-popup-mode").removeClass("active"),$(".settings-popup-mode.normal").addClass("active"),$(".bookmark-checklist-icon").attr("src",function(e,t){return t.replace("checked_dark.svg","checked.svg")}),$(".bookmark-link-menu.add-text").removeClass("dark"),$(".bookmark-link-menu.add-header").removeClass("dark"),$(".bookmark-link-menu.add-image").removeClass("dark"),$(".bookmark-link-menu.add-link").removeClass("dark"),$(".bookmark-link-menu.add-checklist").removeClass("dark"),$(".bookmark-link-menu.remove-link").removeClass("dark"),$(".bookmark-list-menu-open").removeClass("dark"),$("#dropdown-workspaces").removeClass("dark")):"less"==e?($("body").css("background","#F7F7FB"),$(".asidenav").css("background","#F7F7FB"),$(".categories-navigation-container").removeClass("dark"),$(".categories-navigation").removeClass("dark"),$(".container-fluid").removeClass("dark"),$(".container-fluid").removeClass("normal"),$(".container-fluid").addClass("less"),$("#extension-message-container").removeClass("dark"),$("#extension-message-container").addClass("less"),$(".share-container").removeClass("dark"),$(".share-button").css({background:"#FFFFFF",border:"1px solid #E8E8E8"}),$(".share-button").children("svg").children("path").css("stroke","#278CCA"),$(".share-button-text").css("color","#278CCA"),$(".ad-card-div.share-tabs").css("background","none"),$(".ad-card-2").css("filter","none"),t.colorInspiration?($(".ad-card-div.main-page").each(function(){$(this).css("background","linear-gradient(160deg, "+category_color[$(this).attr("id")].color1+", "+category_color[$(this).attr("id")].color2+")")}),$(".title-h1").css("color","#FFFFFF"),$(".post-title").css("color","#FFFFFF"),$(".post-link").css("color","rgba(255,255,255,0.8)")):($(".ad-card-div.main-page").css("background","#FFFFFF"),$(".title-card").each(function(){$(this).children(".title-h1").css("color",category_color[$(this).parent().attr("id")].color1)}),$(".post-title").css("color","#24233D"),$(".post-link").css("color","#7F8287")),$(".asidenav-nav-bottom").removeClass("normal"),$(".asidenav-nav-bottom").removeClass("dark"),$(".asidenav-nav-bottom").addClass("less"),$(".asidenav-nav").removeClass("dark"),$(".asidenav-nav").addClass("normal"),$(".asidenav-nav-icon-container.style1").css("background","#FFFFFF"),$(".asidenav-nav-icon-container.style2.item1").css("background","rgba(128, 188, 107, 0.17)"),$(".asidenav-nav-icon-container.style2.item2").css("background","rgba(87, 177, 189, 0.17)"),$(".asidenav-nav-icon-container.style2.item3").css("background","rgba(101, 177, 232, 0.17)"),$(".asidenav-nav-icon-container.style2.item4").css("background","rgba(74, 135, 226, 0.17)"),$(".asidenav-nav-icon-container.style2.item5").css("background","rgba(101, 122, 237, 0.17)"),$(".asidenav-nav-icon-container.style2.item6").css("background","rgba(138, 107, 226, 0.17)"),$(".asidenav-nav-icon-container.style2.item7").css("background","rgba(208, 100, 119, 0.17)"),$(".asidenav-nav-icon-container.style2.challenges").css("background","rgba(87, 188, 136, 0.17)"),$(".asidenav-nav-icon").attr("src",function(e,t){return t.replace("dark","color")}),$(".asidenav-nav-item").removeClass("dark"),$(".asidenav-nav-dropdown-item").removeClass("dark"),$(".settings-popup-mode").removeClass("active"),$(".settings-popup-mode.less").addClass("active"),$(".bookmark-checklist-icon").attr("src",function(e,t){return t.replace("checked_dark.svg","checked.svg")}),$(".bookmark-link-menu.add-text").removeClass("dark"),$(".bookmark-link-menu.add-header").removeClass("dark"),$(".bookmark-link-menu.add-image").removeClass("dark"),$(".bookmark-link-menu.add-link").removeClass("dark"),$(".bookmark-link-menu.add-checklist").removeClass("dark"),$(".bookmark-link-menu.remove-link").removeClass("dark"),$(".bookmark-list-menu-open").removeClass("dark"),$("#dropdown-workspaces").removeClass("dark")):($("body").css("background","#30314A"),$(".asidenav").css("background","#30314A"),$(".categories-navigation-container").addClass("dark"),$(".categories-navigation").addClass("dark"),$(".container-fluid").removeClass("normal"),$(".container-fluid").removeClass("less"),$(".container-fluid").addClass("dark"),$(".container-fluid").nextAll().addClass("dark"),$("#extension-message-container").removeClass("less"),$("#extension-message-container").addClass("dark"),$(".share-container").addClass("dark"),$(".share-button").css({background:"#61627A",border:"none"}),$(".share-button").children("svg").children("path").css("stroke","#FFFFFF"),$(".share-button-text").css("color","#FFFFFF"),$(".ad-card-div.main-page").css("background","#45465C"),$(".ad-card-div.share-tabs").css("background","none"),$(".ad-card-2").css("filter","grayscale(100%)"),$(".title-h1").css("color","#FFFFFF"),$(".post-title").css("color","#FFFFFF"),$(".post-link").css("color","rgba(255,255,255,0.8)"),$(".asidenav-nav-bottom").removeClass("less"),$(".asidenav-nav-bottom").removeClass("normal"),$(".asidenav-nav-bottom").addClass("dark"),$(".asidenav-nav").addClass("dark"),$(".asidenav-nav").removeClass("normal"),$(".asidenav-nav-icon-container.style1").css("background","#43445B"),$(".asidenav-nav-icon-container.menu path").attr("fill","#FFFFFF"),$(".asidenav-nav-icon-container.style2").css("background","#23243F"),$(".asidenav-nav-icon").attr("src",function(e,t){return t.replace("color","dark")}),$(".asidenav-nav-item").addClass("dark"),$(".asidenav-nav-dropdown-item").addClass("dark"),$(".settings-popup-mode").removeClass("active"),$(".settings-popup-mode.dark").addClass("active"),$(".bookmark-checklist-icon").attr("src",function(e,t){return t.replace("checked.svg","checked_dark.svg")}),$(".bookmark-link-menu.add-text").addClass("dark"),$(".bookmark-link-menu.add-header").addClass("dark"),$(".bookmark-link-menu.add-image").addClass("dark"),$(".bookmark-link-menu.add-link").addClass("dark"),$(".bookmark-link-menu.add-checklist").addClass("dark"),$(".bookmark-link-menu.remove-link").addClass("dark"),$(".bookmark-list-menu-open").addClass("dark"),$("#dropdown-workspaces").addClass("dark"))})}function preloader(){$("#preload").remove();$("#main-content").append('<ul id="preload"><li><div class="bounce"><div></div><div></div><div></div></div></li></ul>'),"92px"==$("#asidenav").css("width")?$("ul#preload").css("left","0px"):$("ul#preload").css("left","170px")}window.innerWidth<=1024?(new_job_position=3,category_display=4):window.innerWidth<=1152?(new_job_position=5,category_display=6):window.innerWidth<=1440?(new_job_position=7,category_display=8):window.innerWidth<=1920?(new_job_position=9,category_display=10):window.innerWidth<=2160?(new_job_position=11,category_display=12):(new_job_position=13,category_display=14),chrome.storage.local.get(["functionalMode","workspacesCount"],e=>{"articles"==e.functionalMode||0==e.workspacesCount?get_array_value_from_storage("uxunicorns_category",e=>{temp_category=e,get_array_value_from_storage("uxunicorns_posts",async e=>{temp_posts=e,temp_category.sort(sortbydate_category),chrome.browserAction.setBadgeText({text:""}),temp_posts.sort(sortbydate),temp_category=sort_category_by_post(temp_category,temp_posts);for(var t=0;t<temp_category.length;t++)category_color[temp_category[t].id]={color1:temp_category[t].color1,color2:temp_category[t].color2};randomCategory(getCategories),document.getElementById("share-button").style.display="fixed"})}):(getBookmarks(),document.getElementById("share-button").style.display="none",get_array_value_from_storage("uxunicorns_category",e=>{temp_category=e,get_array_value_from_storage("uxunicorns_posts",async e=>{temp_posts=e,temp_category.sort(sortbydate_category),chrome.browserAction.setBadgeText({text:""}),temp_posts.sort(sortbydate),temp_category=sort_category_by_post(temp_category,temp_posts);for(var t=0;t<temp_category.length;t++)category_color[temp_category[t].id]={color1:temp_category[t].color1,color2:temp_category[t].color2}})}))}),$(document).ready(function(){$("body").on("click","#ga-twitter",function(){ga("send",{hitType:"event",eventCategory:"Share",eventAction:"click",eventLabel:"Twitter"})}),$("body").on("click","#ga-facebook",function(){ga("send",{hitType:"event",eventCategory:"Share",eventAction:"click",eventLabel:"Facebook"})}),$("body").on("click","#ga-linkedin",function(){ga("send",{hitType:"event",eventCategory:"Share",eventAction:"click",eventLabel:"LinkedIn"})}),$("body").on("click","#ga-pinterest",function(){ga("send",{hitType:"event",eventCategory:"Share",eventAction:"click",eventLabel:"Pinterest"})}),$("body").on("click","#ga-link",function(){ga("send",{hitType:"event",eventCategory:"Share",eventAction:"click",eventLabel:"Clipboard"})}),$("#asidenav").on("click","#cat_link",function(){makeNewActiclesCounter(this);const e=document.getElementById("publish-popup-open");e&&e.remove(),document.getElementById("share-button").style.display="flex",$("html").css("scroll-behavior","auto"),ccat_id=$(this).attr("data_id").split("#")[1],preloader(),$(".container-fluid").addClass("content"),getPostByCategory(ccat_id,getSectionsByCategory),setTimeout(function(){window.scrollTo(0,0),$("html").css("scroll-behavior","smooth")},100)}),$("body").on("click","#share-button",function(){$(".share").toggle("display"),"none"!=$(".shareopen").css("display")?($(".shareopen").hide(),$(".share-button-text").hide(),$(".share-button").css("width","48px"),$(".shareclose").show(),"undefined"!=typeof page_name?($("#share-p1-span").text(category.title),$(".share-linksshare").attr("href",function(e,t){return t.replace("productdesign.tips/","productdesign.tips/html/"+page_name)}),$("#share-copy").text("https://productdesign.tips/html/"+page_name),$("#share-p1-span").text($(".categories-header-h1").text())):$("#share-p1-span").text("Productdesign.tips"),copyToClipboardShare("#share-copy")):($(".share-linksshare.facebook").attr("href","http://www.facebook.com/sharer/sharer.php?u=https://productdesign.tips/"),$(".share-linksshare.twitter").attr("href","http://twitter.com/share?url=https://productdesign.tips/"),$(".share-linksshare.pinterest").attr("href","http://pinterest.com/pin/create/link/?url=https://productdesign.tips/"),$(".share-linksshare.linkedin").attr("href","http://www.linkedin.com/shareArticle?url=https://productdesign.tips/"),$(".shareclose").hide(),$(".share-button").css("width","118px"),$(".shareopen").show(),$(".share-button-text").show())}),document.querySelector(".asidenav-img-container.workspace").addEventListener("click",checkToAddNewWorkspace),$(document).mouseup(function(e){var t=$("#share-container");t.is(e.target)||0!==t.has(e.target).length||($(".share-linksshare.facebook").attr("href","http://www.facebook.com/sharer/sharer.php?u=https://productdesign.tips/"),$(".share-linksshare.twitter").attr("href","http://twitter.com/share?url=https://productdesign.tips/"),$(".share-linksshare.pinterest").attr("href","http://pinterest.com/pin/create/link/?url=https://productdesign.tips/"),$(".share-linksshare.linkedin").attr("href","http://www.linkedin.com/shareArticle?url=https://productdesign.tips/"),"block"==$(".share").css("display")&&$(".share").toggle("display"),$(".shareclose").hide(),$(".shareopen").show(),$(".share-button-text").show(),$(".share-button").css("width","118px"))}),$("body").on("click","#show-post-div",function(){$(".categories-post-div").show(),$("#show-post-div").hide(),$("#hide-post-div").show()}),$("body").on("click","#hide-post-div",function(){$(".categories-post-div").hide(),$("#hide-post-div").hide(),$("#show-post-div").show()}),chrome.storage.local.get(["count_click_browser_action"],function(e){var t;"2"==e.count_click_browser_action&&$("#modal-less").show(),t=Number(e.count_click_browser_action)+1,chrome.storage.local.set({count_click_browser_action:t},function(){})})}),document.addEventListener("DOMContentLoaded",e=>{firebase.auth().onAuthStateChanged(function(e){if(e){chrome.runtime.sendMessage({userStatus:"login",user:e},e=>{});let t=document.querySelector(".bookmark-list-blank-info");t&&(t.style.display="none"),checkBackup(e.uid);const a=9;let o=new Date;new Date(o.getFullYear(),o.getMonth(),o.getDate()+1,a);chrome.storage.local.get(["nextSubscriptionStatusUpdate"],t=>{(!t.nextSubscriptionStatusUpdate||t.nextSubscriptionStatusUpdate&&o>=t.nextSubscriptionStatusUpdate)&&updateSubscriptionStatus(e)}),chrome.storage.local.get(["paymentPlan"],e=>{if("free"==e.paymentPlan){let e=document.querySelector(".extension-message-onclick");e&&(e.addEventListener("click",choosePlan),e.removeEventListener("click",getLoginForm))}})}else{chrome.runtime.sendMessage({userStatus:"logout"},e=>{});let e=document.querySelector(".bookmark-list-blank-info");e&&(e.style.display="block");let t=document.querySelector(".extension-message-onclick");t&&(t.addEventListener("click",getLoginForm),t.removeEventListener("click",choosePlan))}setAsideNavLoginPreference(),rebuildAsideNavWorkspaces()}),chrome.runtime.sendMessage({userStatus:"check"},e=>{}),document.getElementById("close-extension-message").addEventListener("click",()=>{document.getElementById("extension-message-container").style.display="none",chrome.storage.local.get(["extension_message"],e=>{e.extension_message.display=!1,chrome.storage.local.set({extension_message:e.extension_message})})}),chrome.storage.local.get(["newArticlesCounter"],e=>{let t=e.newArticlesCounter,a={};for(var o in t){let e=document.querySelector('p[data_id="'+o+'"]');if(e&&t[o]>0){e.classList.add("new-add");let s=e.parentNode.parentNode.getAttribute("category_group_id");a[s]?a[s]+=t[o]:a[s]=t[o]}}for(var o in a){let e=document.querySelector('div[category_group_id="'+o+'"]').querySelector(".asidenav-nav-icon-container");e.setAttribute("data-before",a[o]),e.classList.add("show-before")}}),document.querySelector(".asidenav-img-container.home").addEventListener("click",closeAsideNav);let t=document.querySelectorAll(".asidenav-nav-item.dropdown"),a=document.querySelectorAll(".asidenav-nav-icon-container.items");t.forEach(e=>{e.addEventListener("click",toggleDropdown)}),a.forEach(e=>{e.addEventListener("click",toggleAsideNav)}),document.querySelector(".asidenav-nav-p.home").addEventListener("click",()=>{if(document.querySelector(".asidenav-nav-item.active")){toggleDropdown(null,"home"),document.querySelector(".asidenav-nav-dropdown-item").classList.contains("active")&&document.querySelector(".asidenav-nav-dropdown-item.active").classList.remove("active")}randomCategory(getCategories)})});var preloaderUniversal=makePreloaderUniversal();function makePreloaderUniversal(){return{start:function(){let e=document.createElement("ul");e.id="preload",e.innerHTML='<li><div class="bounce"><div></div><div></div><div></div></div></li>',document.body.prepend(e)},finish:function(){document.getElementById("preload").remove()}}}function copyToClipboardShare(e){var t=$("<input>");$("body").append(t),t.val($(e).text()).select(),document.execCommand("copy"),t.remove()}function checkViewMode(e){var t=(new Date).getHours();"enabled"==e&&(t<=6||t>=21)?viewMode("dark"):chrome.storage.local.get(["viewMode"],function(e){viewMode(e.viewMode)})}function randomCategory(e){var t=temp_category.slice();chrome.storage.local.get(["random_category"],function(a){1==a.random_category?(t=t.sort(function(){return Math.random()-.5}),e(t)):e(temp_category),chrome.storage.local.set({random_category:!0})})}function makeNewActiclesCounter(e){let t,a=e.getAttribute("data_id"),o=e.parentNode.parentNode.querySelector(".asidenav-nav-icon-container"),s=o.getAttribute("data-before");chrome.storage.local.get(["newArticlesCounter"],i=>{i.newArticlesCounter[a]&&(e.classList.remove("new-add"),t=s-i.newArticlesCounter[a],o.setAttribute("data-before",t),t<=0&&o.classList.remove("show-before"),delete i.newArticlesCounter[a],chrome.storage.local.set({newArticlesCounter:i.newArticlesCounter}))})}function makeWorkspaceCounter(e,t){chrome.storage.local.get(["workspaceBootmarksCounter","workspaces","currentWorkspaceId"],a=>{let o=document.getElementById("workspace-menu"),s=parseInt(o.getAttribute("data-before")),i=t||a.currentWorkspaceId,n=a.workspaceBootmarksCounter,r=document.querySelector('div[workspace_id="'+i+'"]');if(-1!=i)if("current"==e){if(s=0,n)for(var c in n)s+=n[c];else chrome.storage.local.set({workspaceBootmarksCounter:{}});s>0&&(o.classList.add("show-before"),o.setAttribute("data-before",s))}else"next"==e?(s+=1,o.classList.add("show-before"),o.setAttribute("data-before",s),n[i]?n[i]+=1:n[i]=1,r&&r.classList.add("new-add"),chrome.storage.local.set({workspaceBootmarksCounter:n})):"previous"==e?((s-=1)<=0&&(s=0,o.classList.remove("show-before")),o.setAttribute("data-before",s),n[i]?n[i]-=1:n[i]=0,0==n[i]&&r.classList.remove("new-add"),chrome.storage.local.set({workspaceBootmarksCounter:n})):"reset"==e&&(n[i]&&(s-=n[i],delete n[i]),s<=0&&(s=0,o.classList.remove("show-before")),o.setAttribute("data-before",s),r&&r.classList.remove("new-add"),chrome.storage.local.set({workspaceBootmarksCounter:n}))})}function toggleSettingsMenu(e){let t=document.getElementById("settings-popup"),a=e.currentTarget.firstElementChild,o=document.getElementById("settings-popup-close"),s=a.querySelector(".asidenav-nav-icon"),i=document.getElementById("settings-mode-inspiration"),n=document.getElementById("settings-mode-productivity"),r=document.getElementById("settings-theme-dark"),c=document.getElementById("settings-theme-light"),l=document.getElementById("settings-theme-auto");document.getElementById("settings-mode-less"),document.getElementById("settings-mode-dark"),document.getElementById("workspace-switch"),document.getElementById("article-switch"),document.getElementById("color-switch"),document.getElementById("autodark-switch");chrome.storage.local.get(["functionalMode","viewMode","autoDarkMode","colorInspiration","workspacesCount"],e=>{function d(){chrome.storage.local.set({functionalMode:"articles"}),n.classList.remove("active"),i.classList.add("active"),randomCategory(getCategories)}function m(){chrome.storage.local.set({functionalMode:"workspace",isWorkspaceOpen:!0}),i.classList.remove("active"),n.classList.add("active"),rebuildAsideNavWorkspaces(),getBookmarks()}function u(){chrome.storage.local.set({viewMode:"dark",autoDarkMode:"disabled"}),r.classList.add("active"),c.classList.remove("active"),l.classList.remove("active"),viewMode("dark")}function p(){chrome.storage.local.set({viewMode:"less",autoDarkMode:"disabled"}),r.classList.remove("active"),c.classList.add("active"),l.classList.remove("active"),viewMode("less")}function k(){chrome.storage.local.set({viewMode:"less",autoDarkMode:"enabled"}),r.classList.remove("active"),c.classList.remove("active"),l.classList.add("active"),viewMode("less")}function g(){chrome.storage.local.get(["viewMode"],function(e){a.classList.remove("active"),t.style.display="none",o.removeEventListener("click",g),"dark"==e.viewMode?s.setAttribute("src","../img/menu_icon_settings_dark.svg"):s.setAttribute("src","../img/menu_icon_settings_color.svg")}),i.removeEventListener("click",d),n.removeEventListener("click",m),r.removeEventListener("click",u),c.removeEventListener("click",p),l.removeEventListener("click",k)}"workspace"==e.functionalMode?n.classList.add("active"):i.classList.add("active"),"dark"==e.viewMode?r.classList.add("active"):"enabled"==e.autoDarkMode?l.classList.add("active"):c.classList.add("active"),"none"==t.style.display?(t.style.display="block",s.setAttribute("src","../img/menu_icon_settings_white.svg"),a.classList.add("active"),o.addEventListener("click",g)):g(),document.addEventListener("click",function(e){e.target.closest(".settings-popup")||e.target.closest(".asidenav-nav-item.settings")||g()}),i.addEventListener("click",d),n.addEventListener("click",m),r.addEventListener("click",u),c.addEventListener("click",p),l.addEventListener("click",k)})}function autoGrow(e,t){let a=t?e:this;setTimeout(function(){a.style.cssText="-moz-box-sizing:content-box",a.style.cssText="height:"+a.scrollHeight+"px",a.scrollHeight>.8*window.innerHeight&&(a.style.overflowY="auto")},0)}function getPublishPopup(){let e,t,a,o,s,i,n,r;ga("send","pageview","publish-popup");const c=new Image;let l,d={};c.src="/img/icon_photo.svg",c.onload=(()=>{l=getBase64Image(c),chrome.storage.local.get(["bookmarks","caseStudies","workspaces","currentWorkspaceId","images"],function(c){let m,u=c.currentWorkspaceId,p=c.workspaces.findIndex((e,t)=>{if(c.workspaces[t].id==u)return 1});if(c.caseStudies&&c.caseStudies[u])e=c.caseStudies[u].caseStudyTitle,m=c.caseStudies[u].caseStudyData.caseStudyPhoto,t=c.caseStudies[u].caseStudyData.caseStudyAuthorName,a=c.caseStudies[u].caseStudyData.caseStudyAuthorRole,o=c.caseStudies[u].caseStudyData.caseStudySocial.home,s=c.caseStudies[u].caseStudyData.caseStudySocial.twitter,i=c.caseStudies[u].caseStudyData.caseStudySocial.facebook,n=c.caseStudies[u].caseStudyData.caseStudySocial.linkedin,r=c.caseStudies[u].caseStudyData.caseStudySocial.world;else if(c.caseStudies){let l="";for(key in c.caseStudies)""==l?l=key:c.caseStudies[key].caseStudyDate>c.caseStudies[l].caseStudyDate&&(l=key);const d=(new Date).getTime();m="img_"+d,c.images[m]=c.images[c.caseStudies[l].caseStudyData.caseStudyPhoto],e=c.workspaces[p].title,t=c.caseStudies[l].caseStudyData.caseStudyAuthorName,a=c.caseStudies[l].caseStudyData.caseStudyAuthorRole,o=c.caseStudies[l].caseStudyData.caseStudySocial.home,s=c.caseStudies[l].caseStudyData.caseStudySocial.twitter,i=c.caseStudies[l].caseStudyData.caseStudySocial.facebook,n=c.caseStudies[l].caseStudyData.caseStudySocial.linkedin,r=c.caseStudies[l].caseStudyData.caseStudySocial.world}else{e=c.workspaces[p].title,t=a="";const d=(new Date).getTime();m="img_"+d,c.images[m]=l,o=s=i=n=r=""}const k=document.createElement("div");let g;k.id="publish-popup-container",k.className="publish-popup-container",g='<div class="publish-popup-close" id="publish-popup-close"></div>',g+='<div class="publish-popup-hint">&#x1F933 You can convert workspaces into mobile-friendly articles and share them online.',g+="</div>",g+='<div class="publish-popup">',g+='<div class="publish-popup-header">',g+='<h1 class="publish-popup-header-h1 contenteditable" placeholder="Case study title">'+e+"</h1>",g+='<div class="publish-popup-header-info">',g+='<div class="publish-popup-header-about">';let v=(new Date).getTime(),h=new Image,b=c.images[m];if(h.src="data:image/png;base64,"+b,g+='<div><input type="file" accept="image/*" class="bookmark-image-file" id="inp'+v+'"><label class="publish-popup-header-photo" for="inp'+v+'"><img src="'+h.src+'" alt="" class="photo"></label></div>',g+='<div class="publish-popup-header-author">',g+='<p class="publish-popup-header-author-name  contenteditable" placeholder="Authors Name">'+t+"</p>",g+='<p class="publish-popup-header-author-role  contenteditable" placeholder="Authors role in a project or title">'+a+"</p>",g+="</div>",g+="</div>",g+='<div class="publish-popup-header-social-container">',g+='<a class="publish-popup-header-social home" data-url="'+o+'" title="'+o+'" target="_blank"><img src="../img/icon_home.svg"></a>',g+='<a class="publish-popup-header-social twitter" data-url="'+s+'" title="'+s+'" target="_blank"><img src="../img/icon_twitter_s.svg"></a>',g+='<a class="publish-popup-header-social facebook" data-url="'+i+'" title="'+i+'" target="_blank"><img src="../img/icon_facebook_s.svg"></a>',g+='<a class="publish-popup-header-social linkedin" data-url="'+n+'" title="'+n+'" target="_blank"><img src="../img/icon_linkedin_s.svg"></a>',g+='<a class="publish-popup-header-social world" data-url="'+r+'" title="'+r+'" target="_blank"><img src="../img/icon_world_s.svg"></a>',g+="</div>",g+="</div>",g+="</div>",g+='<div class="publish-popup-body">',Object.values(c.bookmarks).forEach(e=>{g+='<div class="publish-popup-list-container">',g+='<h2 class="publish-popup-list-title">'+e.listTitle+"</h2>",e.listBookmarks.forEach(async e=>{if(e.header)g+='<h3 class="publish-popup-capture"><div>'+e.header+"</div></h3>";else if(e.text)g+='<div class="publish-popup-text">'+e.text+"</div>";else if(e.image)if("_none"==e.image)g+='<div class="publish-popup-image"><img src="/img/image_not_found.svg" alt="">',g+="<p>"+e.caption+"</p>";else{let t=new Image,a=c.images[e.image];t.src="data:image/png;base64,"+a,g+='<div class="publish-popup-image"><img src="'+t.src+'" alt="">',g+="<p>"+e.caption+"</p></div>"}else e.url?g+='<div class="publish-popup-link"><a href="'+e.url+'" class="publish-popup-link-url"><div class="publish-popup-link-favicon-container"><img class="publish-popup-link-favicon" src="https://www.google.com/s2/favicons?domain='+e.url+'" alt=""></div><p class="publish-popup-link-title" title="'+e.title+'">'+e.title+'</p><p class="publish-popup-link-source">'+extractHostname(e.url)+"</p></a></div>":e.checklistTitle?g+='<div class="publish-popup-checklist"><img src="../img/menu_icon_workspace_added_color.svg" class="publish-popup-checklist-icon" alt=""><div class="publish-popup-checklist-title">'+e.checklistTitle+"</div></div>":e.media?(g+='<div class="publish-popup-media"><iframe src="'+e.media+'"></iframe>',g+="<p>"+e.caption+"</p></div>"):e.quote&&(g+='<div class="publish-popup-quote"><img src="../img/icon_quote.svg" class="publish-popup-quote-icon" alt=""><div class="publish-popup-quote-title">'+e.quote+"</div></div>")}),g+="</div>"}),g+="</div>",g+='<div class="publish-popup-footer">',g+="</div>",g+='<div class="publish-popup-menu">',c.caseStudies&&c.caseStudies[u]){const e="https://productdesign.tips/case-studies/";let t=u.replace("workspaces_list_",""),a=c.caseStudies[u].caseStudyLink;g+='<div class="publish-popup-menu-link" id="publish-popup-menu-link">',g+='<div class="publish-popup-menu-postlink">',g+='<textarea readonly="">'+(e+t+"-"+a)+"</textarea>"}else g+='<div class="publish-popup-menu-link" id="publish-popup-menu-link">',g+='<div class="publish-popup-menu-postlink">',g+='<textarea readonly="">https://</textarea>';g+="</div>",g+='<div class="publish-popup-menu-copy" id="publish-popup-menu-copy">',g+="<p>Copy</p>",g+="</div>",g+="</div>";let y="Publish";if(c.caseStudies&&c.caseStudies[u]&&(y="Update"),g+='<button class="publish-popup-menu-publish" id="publish-popup-menu-publish">'+y+"</button>",g+="</div>",g+="</div>",k.innerHTML=g,document.body.prepend(k),window.addEventListener("scroll",w),c.caseStudies&&!c.caseStudies[u]){let e=document.querySelector(".contenteditable");e.setAttribute("contenteditable",!0),e.focus(),document.execCommand("selectAll",!1,null),editPublishTitles(null,e)}document.querySelectorAll(".publish-popup-link > a").forEach(e=>{getLinkPreviewImage(e)}),document.getElementById("publish-popup-close").addEventListener("click",()=>{document.body.removeChild(k),window.removeEventListener("scroll",w)}),k.querySelectorAll(".contenteditable").forEach(e=>{e.addEventListener("click",editPublishTitles),c.caseStudies&&c.caseStudies[u]&&(e.style.opacity="1")});let f=k.querySelector(".publish-popup-header-photo");function w(){let e=pageYOffset,t=document.getElementById("publish-popup-close");t.style.top=e<=60?72-e+"px":"12px"}function L(e,t){const a=new Image;a.src="/img/circle_loading.png",a.onload=(()=>{t.innerHTML='<img src="'+a.src+'" alt="" class="photo-loading"></img>',a.src=URL.createObjectURL(e),a.onload=(()=>{c.images[m]=getBase64Image(a),t.innerHTML='<img src="'+a.src+'" alt="" class="photo"></img>',chrome.storage.local.set({images:c.images})}),a.onerror=(()=>{})})}function E(e){ga("send","event","Case Study","click","Publish");var t=firebase.auth().currentUser;let a,o,s,i;const n="https://productdesign.tips/case-studies/";let r=document.querySelector(".publish-popup-header-h1").innerHTML,l=m,p=document.querySelector(".publish-popup-header-author-name").innerHTML,k=document.querySelector(".publish-popup-header-author-role").innerHTML,g={},v=document.querySelector(".publish-popup-header-social.home").getAttribute("data-url"),h=document.querySelector(".publish-popup-header-social.twitter").getAttribute("data-url"),b=document.querySelector(".publish-popup-header-social.facebook").getAttribute("data-url"),y=document.querySelector(".publish-popup-header-social.linkedin").getAttribute("data-url"),f=document.querySelector(".publish-popup-header-social.world").getAttribute("data-url");g.home=null!=v?v:"",g.twitter=null!=h?h:"",g.facebook=null!=b?b:"",g.linkedin=null!=y?y:"",g.world=null!=f?f:"";let w={caseStudyPhoto:l,caseStudyAuthorName:p,caseStudyAuthorRole:k,caseStudyBookmarks:c.bookmarks,caseStudySocial:g,caseStudyImages:d};if(c.caseStudies&&c.caseStudies[u]&&c.caseStudies[u].caseStudyLink){s=c.caseStudies[u].caseStudyLink,o=u.replace("workspaces_list_",""),a=n+o+"-"+s,i="UPDATED";const e=(new Date).getTime();c.caseStudies[u]={caseStudyData:w,caseStudyTitle:r,caseStudyLink:s,caseStudyDate:e},db.ref("users").child(t.uid).child("caseStudies").child(u).update({caseStudyTitle:r,caseStudyData:w}).then(e=>{chrome.storage.local.set({caseStudies:c.caseStudies}),chrome.storage.local.set({images:c.images}),L(i)}).catch(e=>{alert("Somthing went wrong. Try again.")})}else{chrome.storage.local.get(["caseStudies"],e=>{e.caseStudies||document.getElementById("publish-popup-close").addEventListener("click",E)});let e=document.querySelector(".publish-popup-header-h1").innerHTML;s=e=convertToSlug(e),o=u.replace("workspaces_list_",""),a=n+o+"-"+s,i="PUBLISHED",document.getElementById("publish-popup-menu-link").classList.remove("disabled");const l=(new Date).getTime();c.caseStudies[u]={caseStudyData:w,caseStudyTitle:r,caseStudyLink:s,caseStudyDate:l},db.ref("users").child(t.uid).child("caseStudies").child(u).set({caseStudyLink:s,caseStudyTitle:r,caseStudyData:w}).then(e=>{chrome.storage.local.set({caseStudies:c.caseStudies}),chrome.storage.local.set({images:c.images}),L(i)}).catch(e=>{alert("Somthing went wrong. Try again.")})}function L(e){document.querySelectorAll(".contenteditable").forEach(e=>{e.removeEventListener("click",editPublishTitles),e.style.opacity="1"}),document.querySelector(".publish-popup-header-photo").removeEventListener("click",editPublishPhoto),document.querySelector(".publish-popup-header-photo").style.cursor="default",document.querySelectorAll(".publish-popup-header-social").forEach(e=>{e.removeEventListener("click",editPublishSocial),""==e.getAttribute("data-url")?e.style.display="none":e.setAttribute("href",e.getAttribute("data-url"))});let t,o=document.getElementById("publish-popup-menu-publish"),s=document.getElementById("publish-popup-menu-link");t='<div class="publish-popup-menu-postlink"><span>'+e+"</span><textarea readonly>"+a+"</textarea></div>",t+='<div class="publish-popup-menu-copy" id="publish-popup-menu-copy"><p>Copy</p></div>',o.style.display="none",o.innerHTML="Update",s.innerHTML=t,copyToClipboard(document.querySelector(".publish-popup-menu-postlink textarea")),document.getElementById("publish-popup-menu-copy").addEventListener("click",()=>{copyToClipboard(document.querySelector(".publish-popup-menu-postlink textarea"))})}function E(){document.body.style.overflowY="hidden";const e=document.createElement("div");e.className="asidenav-nav-workspace-modal",document.body.prepend(e),e.innerHTML='<div class="popup-close feedback" id="popup-close"></div></div><div class="feedback-container"><iframe src="https://docs.google.com/forms/d/e/1FAIpQLScfOL8B2Kxt5g9Z0owQ1dQyodyXZmEO0X8M_WQFK94dGzRZqw/viewform?embedded=true"width="680" height="519" frameborder="0" marginheight="0" marginwidth="0">Loading…</iframe></div>',document.querySelector(".asidenav-nav-workspace-modal").addEventListener("click",()=>{document.querySelector(".asidenav-nav-workspace-modal").remove(),document.body.style.overflowY=""})}}["dragenter","dragover","dragleave","drop"].forEach(e=>{f.addEventListener(e,imagePreventDefaults,!1),document.body.addEventListener(e,imagePreventDefaults,!1)}),f.previousSibling.addEventListener("change",function(){let e=event.target.files[0];e&&(L(e,f),c.caseStudies||(c.caseStudies={}),c.caseStudies[u]||(c.caseStudies[u]={}),c.caseStudies[u].caseStudyData||(c.caseStudies[u].caseStudyData={}),c.caseStudies[u].caseStudyData.caseStudyPhoto=m)},!1),f.addEventListener("drop",function(){let e=event.dataTransfer.files[0];e&&(L(e,f),c.caseStudies||(c.caseStudies={}),c.caseStudies[u]||(c.caseStudies[u]={}),c.caseStudies[u].caseStudyData||(c.caseStudies[u].caseStudyData={}),c.caseStudies[u].caseStudyData.caseStudyPhoto=m)},!1),k.querySelectorAll(".publish-popup-header-social").forEach(e=>{e.addEventListener("click",editPublishSocial),""!=e.getAttribute("data-url")&&(e.style.opacity="1")}),c.caseStudies&&c.caseStudies[u]&&document.getElementById("publish-popup-menu-copy").addEventListener("click",()=>{copyToClipboard(document.querySelector(".publish-popup-menu-postlink textarea"))}),document.getElementById("publish-popup-menu-publish").addEventListener("click",()=>{firebase.auth().currentUser?(document.getElementById("publish-popup-menu-publish").innerHTML='<img src="/img/circle.png"></img>',c.caseStudies||(c.caseStudies={}),c.caseStudies[u]||(c.caseStudies[u]={}),c.caseStudies[u].caseStudyData||(c.caseStudies[u].caseStudyData={}),c.caseStudies[u].caseStudyData.caseStudyPhoto=m,function(){let e={},t=firebase.auth().currentUser,a=count=0;c.bookmarks.forEach(e=>{e.listBookmarks.forEach(e=>{e.image&&a++})}),a++;for(let o in c.images)c.bookmarks.forEach(s=>{s.listBookmarks.forEach(s=>{if(s.image&&s.image==o){const s=firebase.storage(),i=s.ref(),n=i.child("user_images/"+t.uid+"/"+o);n.getDownloadURL().then(t=>{count++,e[o]=t,a==count&&(d=e,E())}).catch(()=>{let t=base64toBlob(c.images[o],"image/png");const s=n.put(t);s.on("state_changed",e=>{},t=>{count++,e[o]="https://firebasestorage.googleapis.com/v0/b/uxunicorns-fca1e.appspot.com/o/image_not_found.svg?alt=media&token=ca5ceb1e-ae62-43b1-9f69-f33ce6c7dc64",a==count&&(d=e,E())},()=>{s.snapshot.ref.getDownloadURL().then(function(t){count++,e[o]=t,a==count&&(d=e,E())})})})}})});const o=base64toBlob(c.images[m],"image/png"),s=firebase.storage().ref().child("user_images/"+t.uid+"/"+m).put(o);s.on("state_changed",e=>{},t=>{count++,e[m]="https://firebasestorage.googleapis.com/v0/b/uxunicorns-fca1e.appspot.com/o/image_not_found.svg?alt=media&token=ca5ceb1e-ae62-43b1-9f69-f33ce6c7dc64",a==count&&(d=e,E())},()=>{s.snapshot.ref.getDownloadURL().then(function(t){count++,e[m]=t,a==count&&(d=e,E())})})}()):getLoginForm()}),checkCaseStudyTitles()})})}function editPublishTitles(e,t){let a=e?e.currentTarget:t,o=a.innerHTML;function s(e){if(13===e.keyCode){a.removeEventListener("keydown",s),a.removeEventListener("blur",i),a.removeEventListener("paste",n);let t=a.innerHTML;e.preventDefault(),a.setAttribute("contenteditable",!1),a.style.outline="",a.style.cursor="text",o!=t&&t.replace(/&nbsp;/g,"").length?a.style.opacity="1":a.innerHTML=o}else 27===e.keyCode&&(a.removeEventListener("keydown",s),a.removeEventListener("blur",i),a.removeEventListener("paste",n),a.setAttribute("contenteditable",!1),a.style.outline="",a.innerHTML=o,a.style.cursor="text");checkCaseStudyTitles()}function i(e){let t=a.innerHTML;a.setAttribute("contenteditable",!1),a.style.outline="",a.style.cursor="text",o!=t&&t.replace(/&nbsp;/g,"").length?a.style.opacity="1":a.innerHTML=o,a.removeEventListener("keydown",s),a.removeEventListener("blur",i),a.removeEventListener("paste",n),checkCaseStudyTitles()}function n(e){e.preventDefault();let t=e.clipboardData.getData("text/plain");t=t.replace(/\</g,"&lt;").replace(/\>/g,"&gt;"),document.execCommand("insertHTML",!1,t)}a.setAttribute("contenteditable",!0),a.focus(),a.style.cursor="auto",document.execCommand("selectAll",!1,null),a.style.outline="1px solid #65B1E8",a.addEventListener("keydown",s),a.addEventListener("blur",i),a.addEventListener("paste",n)}function checkCaseStudyTitles(){return!1}function editPublishSocial(e){let t=document.querySelector(".publish-popup-header-social-container"),a=e.target,o=document.createElement("input");o.setAttribute("placeholder","https://"),o.className="publish-popup-input",t.appendChild(o),o.focus();let s,i=a.getAttribute("data-url").length>0?a.getAttribute("data-url"):"http://";function n(e){o.remove()}o.setAttribute("placeholder",i),o.addEventListener("keydown",function(e){13===e.keyCode?""!=(s=o.value)&&(!function(e){if(new RegExp(/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi).test(e)){let t=e.slice(0,7),a=e.slice(0,8);return"http://"==t||"https://"==a||(s="//"+s,!0)}return!1}(s)?animateCSS(o,"shake"):(a.setAttribute("data-url",s),a.setAttribute("title",s),a.style.opacity="1",o.removeEventListener("blur",n),o.remove())):27===e.keyCode&&(o.removeEventListener("blur",n),o.remove())}),o.addEventListener("blur",n)}function editPublishPhoto(e){let t=document.querySelector(".publish-popup-header-about"),a=e.target,o=document.createElement("input");function s(e){o.remove()}o.setAttribute("placeholder","http://"),o.className="publish-popup-input",t.appendChild(o),o.focus(),o.addEventListener("keydown",function(e){if(13===e.keyCode){let e=o.value;""!=e&&(!function(e){if(new RegExp(/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi).test(e)){let t=e.slice(0,7),a=e.slice(0,8);if("http://"==t||"https://"==a)return!0}return!1}(e)?animateCSS(o,"shake"):(imgObj.src=e,imgObj.onerror=(()=>{animateCSS(o,"shake")}),imgObj.onload=(()=>{a.style.backgroundImage='url("'+e+'")',a.style.backgroundSize="cover",a.style.opacity="1",o.removeEventListener("blur",s),o.remove()})))}else 27===e.keyCode&&(o.removeEventListener("blur",s),o.remove())}),o.addEventListener("blur",s)}function extractHostname(e){let t;return t=(t=(t=e.indexOf("//")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0]).split("?")[0]}function copyToClipboard(e){return e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),e.value}function convertToSlug(e){e=(e=e.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var t="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",a=0,o=t.length;a<o;a++)e=e.replace(new RegExp(t.charAt(a),"g"),"aaaaeeeeiiiioooouuuunc------".charAt(a));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}function loginSignOut(){let e=firebase.auth().currentUser;chrome.storage.local.set({isSignOut:!0}),saveDataToDatabase(e.uid,"with callback")}function resetLocalStorageData(){firebase.auth().signOut().then(()=>{document.getElementById("user-login").removeEventListener("click",getAccountInfoForm),chrome.storage.local.get(["functionalMode"],e=>{preloader(),document.querySelector(".asidenav-img.account").classList.remove("timer"),chrome.storage.local.set({timestampBackup:""}),chrome.storage.local.set({workspacesCount:1}),chrome.storage.local.set({backupWorkspace:{}}),chrome.storage.local.set({newArticlesCounter:{}}),chrome.storage.local.set({paymentPlan:"free"}),chrome.storage.local.set({workspaceBootmarksCounter:{}}),chrome.storage.local.remove(["backupColumn","backupWorkspace"]),chrome.storage.local.get(["workspaceTemplates"],e=>{let t=(new Date).getTime(),a=e.workspaceTemplates["Design Links"];chrome.storage.local.set({workspaces:[{bookmarks:a.bookmarks,bookmarksListCount:a.bookmarksListCount,id:"workspaces_list_"+t,title:"Design Links"}]}),chrome.storage.local.set({bookmarksListCount:a.bookmarksListCount}),chrome.storage.local.set({bookmarks:a.bookmarks}),chrome.storage.local.set({currentWorkspaceId:"workspaces_list_"+t}),chrome.storage.local.set({isSignOut:!1}),rebuildAsideNavWorkspaces()}),"workspace"==e.functionalMode?getBookmarks():randomCategory(getCategories)})},function(e){console.log(e.message)})}function setAsideNavLoginPreference(){chrome.storage.local.get(["paymentPlan","freeBackup"],e=>{let t=firebase.auth().currentUser,a=document.querySelector(".asidenav-nav-icon-container.login"),o=document.querySelector(".asidenav-nav-p.login"),s=document.getElementById("user-login"),i=document.querySelector(".asidenav-img-container.account"),n=document.querySelector(".asidenav-img.account");if(n.innerHTML="",t){let r=t.email.split("@")[0];if(a.classList.add("items","asidenav-open"),s.style.cursor="default",s.removeEventListener("click",getLoginForm),s.addEventListener("click",getAccountInfoForm),o.innerHTML=r,"free"==e.paymentPlan){let t=(new Date).getTime(),a=(e.freeBackup,(e.freeBackup-t)/1e3);i.classList.remove("login"),i.classList.remove("logout"),i.classList.add("noconnection"),i.style.cursor="pointer",i.addEventListener("click",choosePlan),i.setAttribute("title","Upgrade to Pro to synch your data immediately. Free account allows you to backup data once in 24 hours."),n.classList.add("timer"),n.innerHTML="PROCESSING...",function(e,t){let a,o,s,i=e;timerFunction=setInterval(function(){a=parseInt(i/3600,10),o=parseInt(i%3600/60,10),s=parseInt(i%60,10),a=a<10?"0"+a:a,o=o<10?"0"+o:o,s=s<10?"0"+s:s,t.classList.contains("timer")&&(t.textContent="BACKUP IN "+a+":"+o+":"+s),--i<0&&(i=e)},1e3)}(a,n)}else if(n.classList.remove("timer"),navigator.onLine){i.classList.remove("login"),i.classList.remove("noconnection"),i.classList.add("logout"),i.setAttribute("title","Your data is synching automatically."),n.innerHTML="AUTOSAVE",setInterval(async function(){try{await fetch("https://google.com/"),i.classList.remove("login"),i.classList.remove("noconnection"),i.classList.add("logout"),i.setAttribute("title","Your data is synching automatically."),n.innerHTML="AUTOSAVE"}catch{i.classList.remove("login"),i.classList.remove("logout"),i.classList.add("noconnection"),i.setAttribute("title","Your work will be synched as soon as an internet connection will be recovered."),n.innerHTML="NO CONNECTION"}},3e5)}else i.classList.remove("login"),i.classList.remove("logout"),i.classList.add("noconnection"),i.setAttribute("title","Your work will be synched as soon as an internet connection will be recovered."),n.innerHTML="NO CONNECTION"}else a.classList.remove("items","asidenav-open"),s.style.cursor="pointer",s.addEventListener("click",getLoginForm),o.innerHTML="Log in",i.removeEventListener("click",choosePlan),i.classList.remove("logout"),i.classList.remove("noconnection"),i.classList.add("login"),i.style.cursor="default",n.innerHTML="NO BACKUP"})}function saveDataToDatabase(e,t){let a,o=new Date;a=o.getHours()>=9?new Date(o.getFullYear(),o.getMonth(),o.getDate()+1,9).getTime():new Date(o.getFullYear(),o.getMonth(),o.getDate(),9).getTime(),chrome.storage.local.get(["bookmarks","bookmarksListCount","workspaces","workspacesCount","currentWorkspaceId","viewMode","autoDarkMode","functionalMode","colorInspiration","timestampBackup"],o=>{if(o.workspaces.forEach((e,t)=>{e.id==o.currentWorkspaceId&&(o.workspaces[t]={bookmarks:o.bookmarks,bookmarksListCount:o.bookmarksListCount,id:e.id,title:e.title})}),db.ref("users").child(e).update({bookmarks:o.bookmarks,bookmarksListCount:o.bookmarksListCount,workspaces:o.workspaces,workspacesCount:o.workspacesCount,currentWorkspaceId:o.currentWorkspaceId,viewMode:o.viewMode,autoDarkMode:o.autoDarkMode,functionalMode:o.functionalMode,colorInspiration:o.colorInspiration,timestampBackup:o.timestampBackup}),chrome.storage.local.set({freeBackup:a}),"with callback"==t){new SaveImagesToDatabase(e,resetLocalStorageData)}else{new SaveImagesToDatabase(e)}})}function SaveImagesToDatabase(e,t){chrome.storage.local.get(["images","templateImages"],a=>{let o={},s=0,i=0;for(let e in a.images)s++;for(let t in a.images){const n=t,r=firebase.storage().ref().child("user_images/"+e+"/"+t);r.getDownloadURL().then(t=>{if(i++,o[n]=t,s==i){let t=Date.now();db.ref("users").child(e).update({images:o,timestampBackup:t})}}).catch(t=>{let c=base64toBlob(a.images[n],"image/png");const l=r.put(c);l.on("state_changed",e=>{},t=>{if(i++,o[n]="https://firebasestorage.googleapis.com/v0/b/uxunicorns-fca1e.appspot.com/o/image_not_found.svg?alt=media&token=ca5ceb1e-ae62-43b1-9f69-f33ce6c7dc64",s==i){let t=Date.now();db.ref("users").child(e).update({images:o,timestampBackup:t})}},()=>{l.snapshot.ref.getDownloadURL().then(function(t){if(i++,o[n]=t,s==i){let t=Date.now();db.ref("users").child(e).update({images:o,timestampBackup:t})}})})})}t&&t()})}function base64toBlob(e,t){t=t||"";for(var a=atob(e),o=a.length,s=Math.ceil(o/1024),i=new Array(s),n=0;n<s;++n){for(var r=1024*n,c=Math.min(r+1024,o),l=new Array(c-r),d=r,m=0;d<c;++m,++d)l[m]=a[d].charCodeAt(0);i[n]=new Uint8Array(l)}return new Blob(i,{type:t})}function getDataFromDatabase(e){preloader();let t,a=new Date;t=a.getHours()>=9?new Date(a.getFullYear(),a.getMonth(),a.getDate()+1,9).getTime():new Date(a.getFullYear(),a.getMonth(),a.getDate(),9).getTime(),db.ref("users/"+e).once("value",a=>{let o=a.val();if("bookmarks"in o)for(let e in o.bookmarks)"listBookmarks"in o.bookmarks[e]||(o.bookmarks[e].listBookmarks=[]);else o.bookmarks=[],o.bookmarksListCount=0;if("workspaces"in o)for(let e in o.workspaces)if("bookmarks"in o.workspaces[e])for(let t in o.workspaces[e])Array.isArray(o.workspaces[e][t])&&o.workspaces[e][t].forEach((a,s)=>{"listBookmarks"in a||(o.workspaces[e][t][s]={listBookmarks:[],listId:a.listId,listTitle:a.listTitle})});else o.workspaces[e].bookmarks=[];else{const e=(new Date).getTime();o.workspaces=[{bookmarks:o.bookmarks,bookmarksListCount:0,id:"workspaces_list_"+e,title:"New workspace 1"}],o.workspacesCount=1,o.currentWorkspaceId="workspaces_list_"+e}chrome.storage.local.set({bookmarks:o.bookmarks,workspaces:o.workspaces,workspacesCount:o.workspacesCount,currentWorkspaceId:o.currentWorkspaceId,viewMode:o.viewMode,autoDarkMode:o.autoDarkMode,colorInspiration:o.colorInspiration,functionalMode:o.functionalMode,caseStudies:o.caseStudies,freeBackup:t,bookmarksListCount:o.bookmarks.length}),loadImagesFromDatabase(e)})}function loadImagesFromDatabase(e){let t=[],a=[];db.ref("users/"+e).once("value",function(e){let o=e.val(),s=0;for(image in o.images)s++;let i=0;for(image in o.images){let e=image,n=new Image;n.src=o.images[image],n.onload=(()=>{i++,t.push([e]),a.push(getBase64Image(n)),i==s&&chrome.storage.local.get(["images"],e=>{t.forEach((t,o)=>{e.images[t]=a[o]}),chrome.storage.local.set({images:e.images,timestampBackup:o.timestampBackup}),chrome.storage.local.get(["functionalMode"],e=>{"articles"==e.functionalMode?randomCategory(getCategories):getBookmarks()})})}),n.onerror=(()=>{i++,n.src="/img/image_not_found.svg",n.onload=(()=>{t.push([e]),a.push(getBase64Image(n)),i==s&&chrome.storage.local.get(["images"],e=>{t.forEach((t,o)=>{e.images[t]=a[o]}),chrome.storage.local.set({images:e.images,timestampBackup:o.timestampBackup}),chrome.storage.local.get(["functionalMode"],e=>{"articles"==e.functionalMode?randomCategory(getCategories):getBookmarks()})})})})}})}async function getLinkPreviewImage(e){let t,a=e.getAttribute("href"),o=e.querySelector("img"),s=await fetch(a),i=await s.text(),n=(new DOMParser).parseFromString(i,"text/html"),r=n.querySelector('meta[property="og:image"]'),c=n.querySelector('meta[name="twitter:image:src"]');if(r)t=r.getAttribute("content"),o.classList.add("find"),o.setAttribute("src",t);else if(c)t=c.getAttribute("content"),o.classList.add("find"),o.setAttribute("src",t);else{let e=n.querySelectorAll("img");Array.prototype.find.call(e,e=>{e.getAttribute("width")>=212&&e.getAttribute("height")>=160&&(e.classList.add("find"),e.setAttribute("src",t))})}}function getLinkTitle(e,t,a,o,s){let i=t;i=i.startsWith("http://")?i.slice(7):i.slice(8);let n=new XMLHttpRequest;n.open("GET","https://url-title.now.sh/"+encodeURI(i),!0),n.send(),n.onload=async function(){if(200==n.status){if(title=n.response,n.response)i(title);else{let e=await fetch(t),a=await e.text(),o=(new DOMParser).parseFromString(a,"text/html").querySelector("title");title=o?o.innerHTML:t,i(title)}function i(i){e.innerHTML='<a href="'+t+'" class="bookmark-link"><div class="bookmark-favicon"><img src="'+a+'" alt=""></div><p class="bookmark-title" title="'+i+'">'+i+"</p></a>",e.style.opacity=1,s.scrollTop=s.scrollHeight,chrome.storage.local.get(["bookmarks"],function(e){e.bookmarks[o].listBookmarks.push({url:t,favIconUrl:a,title:i}),chrome.storage.local.set({bookmarks:e.bookmarks})})}}else console.log("HTTP error. Can't load the title")}}function getLinkSimpleTitle(e,t,a,o){e.innerHTML='<a href="https://www.google.com/search?q='+t+'" class="bookmark-link"><div class="bookmark-favicon"><img src="/img/icon_link.svg" alt=""></div><p class="bookmark-title" title="'+t+'">'+t+"</p></a>",e.style.opacity=1,o.scrollTop=o.scrollHeight,chrome.storage.local.get(["bookmarks"],function(e){e.bookmarks[a].listBookmarks.push({url:"https://www.google.com/search?q="+t,favIconUrl:"/img/icon_link.svg",title:t}),chrome.storage.local.set({bookmarks:e.bookmarks})})}var checkNewData=function(e,t){let a=firebase.auth().currentUser,o=Date.now();chrome.storage.local.get(["isSignOut"],t=>{if(!t.isSignOut&&a){const t=["uxunicorn","workspaceBootmarksCounter","random_category","nextUpdate","newArticlesCounter","backupColumn","backupWorkspace","backupImages","templates","timestampBackup","isSignOut"];for(var s in e){let i=e[s];t.some(e=>s.includes(e))||("paddleSubscriptionLink"==s?i.newValue&&(i.newValue.includes("Error")?(preloaderUniversal.finish(),alert(i.newValue),chrome.storage.local.set({paddleSubscriptionLink:""})):(chrome.storage.local.set({paddleSubscriptionLink:""}),window.open(i.newValue,"_self"))):"paymentPlan"==s?db.ref("payments/"+a.uid+"/subscription/plan/plan_nickname").once("value",e=>{let t=e.val();chrome.storage.local.set({paymentPlan:t}),rebuildAsideNavWorkspaces(),setAsideNavLoginPreference()}):(chrome.storage.local.set({timestampBackup:o}),chrome.storage.local.get(["paymentPlan","bookmarks","workspaces","currentWorkspaceId"],e=>{if("free"!=e.paymentPlan)if("images"==s){new SaveImagesToDatabase(a.uid)}else db.ref("users").child(a.uid).update({[s]:i.newValue,timestampBackup:o}).then(()=>{}).catch(e=>{console.log("---Data could not be saved."+e)})})))}}})};function checkBackup(e){chrome.storage.local.get(["timestampBackup","paymentPlan","freeBackup"],t=>{if(t.paymentPlan)if("free"!=t.paymentPlan)t.timestampBackup?db.ref("users/"+e+"/timestampBackup").once("value",a=>{t.timestampBackup>a.val()?saveDataToDatabase(e):t.timestampBackup<a.val()&&getDataFromDatabase(e)}):getDataFromDatabase(e);else if(t.freeBackup){Date.now()>=t.freeBackup&&saveDataToDatabase(e)}else getDataFromDatabase(e);else getDataFromDatabase(e)})}function updateSubscriptionStatus(e){let t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,9);db.ref("/payments/"+e.uid+"/subscription").once("value",o=>{let s=o.val(),i=new Date(s.current_period_end);i.setDate(i.getDate()+1)<t?(db.ref("/payments/"+e.uid+"/subscription").set({firstSubscription:!1,status:"active",plan:{plan_nickname:"free"}}),chrome.storage.local.set({paymentPlan:"free",subscriptionStatus:"active",nextSubscriptionStatusUpdate:a.getTime()})):chrome.storage.local.set({paymentPlan:s.plan.plan_nickname,subscriptionStatus:s.status,nextSubscriptionStatusUpdate:a.getTime()})})}chrome.storage.onChanged.addListener(checkNewData),window.addEventListener("offline",setAsideNavLoginPreference),window.addEventListener("online",setAsideNavLoginPreference);